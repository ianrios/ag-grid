{"version":3,"sources":["reactUi/header/headerCellComp.tsx"],"names":[],"mappings":"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","file":"headerCellComp.mjs","sourcesContent":["import React, { memo, useCallback, useContext, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { BeansContext } from '../beansContext';\nimport { CssClassManager, HeaderCellCtrl, IHeader, IHeaderCellComp, UserCompDetails, _ } from '@ag-grid-community/core';\nimport { isComponentStateless } from '../utils';\nimport { showJsComp } from '../jsComp';\n\nconst HeaderCellComp = (props: {ctrl: HeaderCellCtrl}) => {\n\n    const { ctrl } = props;\n\n    const { context } = useContext(BeansContext);\n    const colId = ctrl.getColId();\n    const [userCompDetails, setUserCompDetails] = useState<UserCompDetails>();\n\n    const eGui = useRef<HTMLDivElement | null>(null);\n    const eResize = useRef<HTMLDivElement>(null);\n    const eHeaderCompWrapper = useRef<HTMLDivElement>(null);\n    const userCompRef = useRef<IHeader>();\n\n    let cssClassManager = useRef<CssClassManager>();\n    if(!cssClassManager.current){\n        cssClassManager.current = new CssClassManager(() => eGui.current);\n    }\n    const setRef = useCallback((e: HTMLDivElement) => {\n        eGui.current = e;\n        if (!eGui.current) {\n            // Any clean up required?\n            return;\n        }\n\n        const compProxy: IHeaderCellComp = {\n            setWidth: width => {\n                if (eGui.current) {\n                    eGui.current.style.width = width;\n                }\n            },\n            addOrRemoveCssClass: (name, on) => cssClassManager.current!.addOrRemoveCssClass(name, on),\n            setAriaDescription: label => {\n                if (eGui.current) {\n                    _.setAriaDescription(eGui.current, label)\n                }\n            },\n            setAriaSort: sort => {\n                if (eGui.current) {\n                    sort ? _.setAriaSort(eGui.current, sort) : _.removeAriaSort(eGui.current)\n                }\n            },\n            setUserCompDetails: compDetails => setUserCompDetails(compDetails),\n            getUserCompInstance: () => userCompRef.current || undefined\n        };\n\n        ctrl.setComp(compProxy, eGui.current, eResize.current!, eHeaderCompWrapper.current!);\n\n        const selectAllGui = ctrl.getSelectAllGui();\n        eResize.current?.insertAdjacentElement('afterend', selectAllGui);\n    }, []);\n\n    // js comps\n    useLayoutEffect(() => showJsComp(userCompDetails, context, eHeaderCompWrapper.current!, userCompRef), [userCompDetails]);\n\n    // add drag handling, must be done after component is added to the dom\n    useEffect(() => {\n        ctrl.setDragSource(eGui.current!);\n    }, [userCompDetails]);\n\n    const userCompStateless = useMemo(() => {\n        const res = userCompDetails?.componentFromFramework && isComponentStateless(userCompDetails.componentClass);\n        return !!res;\n    }, [userCompDetails]);\n\n    const reactUserComp = userCompDetails && userCompDetails.componentFromFramework;\n    const UserCompClass = userCompDetails && userCompDetails.componentClass;\n\n    return (\n        <div\n            ref={setRef}\n            className=\"ag-header-cell\"\n            col-id={colId}\n            role=\"columnheader\"\n            tabIndex={-1}\n        >\n            <div ref={eResize} className=\"ag-header-cell-resize\" role=\"presentation\"></div>\n            <div ref={eHeaderCompWrapper} className=\"ag-header-cell-comp-wrapper\" role=\"presentation\">\n            { reactUserComp && userCompStateless && <UserCompClass { ...userCompDetails!.params } /> }\n            { reactUserComp && !userCompStateless && <UserCompClass { ...userCompDetails!.params } ref={ userCompRef }/> }\n            </div>\n        </div>\n    );\n};\n\nexport default memo(HeaderCellComp);\n"]}