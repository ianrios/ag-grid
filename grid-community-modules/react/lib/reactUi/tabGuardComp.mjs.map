{"version":3,"sources":["reactUi/tabGuardComp.tsx"],"names":[],"mappings":"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","file":"tabGuardComp.mjs","sourcesContent":["import React, { ForwardRefRenderFunction, forwardRef, memo, useCallback, useContext, useImperativeHandle, useRef } from 'react';\n\nimport {\n    GridCtrl,\n    ITabGuard,\n    TabGuardClassNames,\n    TabGuardCtrl\n} from '@ag-grid-community/core';\nimport { BeansContext } from './beansContext';\n\nexport interface TabGuardCompCallback {\n    forceFocusOutOfContainer(): void;\n}\n\ninterface TabGuardProps {\n    children: React.ReactNode,\n    eFocusableElement: HTMLDivElement,\n    onTabKeyDown: (e: KeyboardEvent) => void,\n    gridCtrl: GridCtrl,\n}\n\nconst TabGuardCompRef: ForwardRefRenderFunction<TabGuardCompCallback, TabGuardProps> = (props: any, forwardRef: any) => {\n\n    const { children, eFocusableElement, onTabKeyDown, gridCtrl } = props;\n    const { context } = useContext(BeansContext);\n\n    const topTabGuardRef = useRef<HTMLDivElement | null>(null);\n    const bottomTabGuardRef = useRef<HTMLDivElement | null>(null);\n    const tabGuardCtrlRef = useRef<TabGuardCtrl | null>();\n\n    const setTabIndex = (value?: string | null) => {\n        const processedValue = value == null ? undefined : parseInt(value, 10).toString();\n\n        [topTabGuardRef, bottomTabGuardRef].forEach(tabGuard => {\n            if (processedValue === undefined) {\n                tabGuard.current?.removeAttribute('tabindex');\n            } else {\n                tabGuard.current?.setAttribute('tabindex', processedValue);\n            }\n            \n        })\n    }\n\n    useImperativeHandle(forwardRef, () => ({\n        forceFocusOutOfContainer() {\n            tabGuardCtrlRef.current?.forceFocusOutOfContainer();\n        }\n    }));\n\n    const setupCtrl = useCallback(() => {\n\n        if (!topTabGuardRef.current && !bottomTabGuardRef.current) {\n            // Clean up after both refs have been removed\n            context.destroyBean(tabGuardCtrlRef.current);\n            tabGuardCtrlRef.current = null;\n            return;\n        } \n\n        if (topTabGuardRef.current && bottomTabGuardRef.current) {\n            const compProxy: ITabGuard = {\n                setTabIndex\n            };\n\n            tabGuardCtrlRef.current = context.createBean(new TabGuardCtrl({\n                comp: compProxy,\n                eTopGuard: topTabGuardRef.current,\n                eBottomGuard: bottomTabGuardRef.current,\n                eFocusableElement: eFocusableElement,\n\n                onTabKeyDown: onTabKeyDown,\n                focusInnerElement: (fromBottom: any) => gridCtrl.focusInnerElement(fromBottom)\n            }));\n        }\n    }, []);\n\n    const setTopRef = useCallback((e: HTMLDivElement) => {\n        topTabGuardRef.current = e;\n        setupCtrl();\n    }, [setupCtrl]);\n    const setBottomRef = useCallback((e: HTMLDivElement) => {\n        bottomTabGuardRef.current = e;\n        setupCtrl();\n    }, [setupCtrl]);\n\n    const createTabGuard = (side: 'top' | 'bottom') => {\n        const className = side === 'top' ? TabGuardClassNames.TAB_GUARD_TOP : TabGuardClassNames.TAB_GUARD_BOTTOM;\n\n        return (\n            <div \n                className={ `${TabGuardClassNames.TAB_GUARD} ${className}` }\n                role=\"presentation\"\n                ref={side === 'top' ? setTopRef : setBottomRef}\n            ></div>\n        );\n    }\n\n    return (\n        <>\n            {createTabGuard('top')}\n            { children }\n            {createTabGuard('bottom')}\n        </>\n    )\n};\n\nconst TabGuardComp = forwardRef(TabGuardCompRef);\n\nexport default memo(TabGuardComp);\n"]}