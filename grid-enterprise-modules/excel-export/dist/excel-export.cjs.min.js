/**
          * @ag-grid-enterprise/excel-export - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v31.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/excel-export - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v31.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@ag-grid-community/core"),t=require("@ag-grid-enterprise/core"),r=require("@ag-grid-community/csv-export"),n=function(e){var t=(new Date).toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t}]}},o=function(e){var t=e.name,r=e.ContentType;return{name:t,properties:{rawMap:{Extension:e.Extension,PartName:e.PartName,ContentType:r}}}},a=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},i=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},l=function(e){var t=new Array(e).fill(void 0).map((function(e,t){return{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:"/xl/worksheets/sheet".concat(t+1,".xml")}})),r=Ze.worksheetImages.size,n={};Ze.workbookImageIds.forEach((function(e){n[e.type]=!0}));var l=new Array(r).fill(void 0).map((function(e,t){return{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:"/xl/drawings/drawing".concat(t+1,".xml")}})),s=Object.keys(n).map((function(e){return{name:"Default",ContentType:"image/".concat(e),Extension:e}}));return{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:i(i(i(i(i(i([],a(s),!1),[{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"}],!1),a(t),!1),[{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"}],!1),a(l),!1),[{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}],!1).map((function(e){return o(e)}))}},s={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},c=function(e){return Math.ceil(9525*e)},p=function(e,t){if(t){var r,n;if("number"==typeof t)r=t;else r=t({rowIndex:e});return n=r,Math.round(72*n/96)}},u=function(e){var t=r.XmlFactory.createHeader({encoding:"UTF-8",standalone:"yes"}),n=r.XmlFactory.createXml(e);return"".concat(t).concat(n)},d=function(e){var t=String.fromCharCode,r=Math.floor(e/26),n=e%26;return r&&26!==e?n?r<26?t(65+r-1)+t(65+n-1):d(r)+t(65+n-1):d(r-1)+"Z":t(65+e-1)},f=function(e,t){return{name:"xdr:".concat(e),children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}},h=function(e){var t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},m=function(e,t){return{name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:null!=e.altText?e.altText:void 0}},children:[h(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}},g=function(e){if(e.saturation||e.tint){var t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:1e3*e.saturation}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:1e3*e.tint}}}),t}},y=function(e,t){var r,n,o;if(e.transparency){var a=Math.min(Math.max(e.transparency,0),100);r=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(1e3*a)}}}]}if(e.recolor)switch(r||(r=[]),e.recolor.toLocaleLowerCase()){case"grayscale":r.push({name:"a:grayscl"});break;case"sepia":r.push((o={color:"D9C3A5",tint:50,saturation:180},{name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:(n={color:"black"}).color}},children:g(n)},{name:"a:srgbClr",properties:{rawMap:{val:o.color}},children:g(o)}]}));break;case"washout":r.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}})}return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":"rId".concat(t),"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:r},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},v=function(e,t){var r={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};if(e.rotation){var n=e.rotation;r.properties={rawMap:{rot:6e4*Math.min(Math.max(n,0),360)}}}return{name:"xdr:spPr",children:[r,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},w=function(e,t,r,n){return{name:"xdr:pic",children:[m(e,t+1),y(e,r+1),v(e,n)]}},x=function(e){var t=e.sheetIndex,r=Ze.worksheetImages.get(t),n=Ze.worksheetImageIds.get(t);return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:r.map((function(e,t){var r=function(e){e.fitCell=!!e.fitCell||!e.width||!e.height;var t=e.position,r=void 0===t?{}:t,n=e.fitCell,o=e.width,a=void 0===o?0:o,i=e.height,l=void 0===i?0:i,s=e.totalHeight,p=e.totalWidth,u=r.offsetX,d=void 0===u?0:u,f=r.offsetY,h=void 0===f?0:f,m=r.row,g=void 0===m?1:m,y=r.rowSpan,v=void 0===y?1:y,w=r.column,x=void 0===w?1:w,S=r.colSpan,b=void 0===S?1:S;return{from:{row:g-1,col:x-1,offsetX:c(d),offsetY:c(h)},to:{row:g-1+(n?1:v-1),col:x-1+(n?1:b-1),offsetX:c(a+d),offsetY:c(l+h)},height:c(s||l),width:c(p||a)}}(e);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[f("from",r.from),f("to",r.to),w(e,t,n.get(e.id).index,r),{name:"xdr:clientData"}]}}))}},S=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},b=function(e){var t=S(e,4),r=t[0],n=t[1],o=t[2],a=t[3];return{name:"a:".concat(r),children:[{name:"a:".concat(n),properties:{rawMap:{val:o,lastClr:a}}}]}},M=function(){return{name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[b(["dk1","sysClr","windowText","000000"]),b(["lt1","sysClr","window","FFFFFF"]),b(["dk2","srgbClr","44546A"]),b(["lt2","srgbClr","E7E6E6"]),b(["accent1","srgbClr","4472C4"]),b(["accent2","srgbClr","ED7D31"]),b(["accent3","srgbClr","A5A5A5"]),b(["accent4","srgbClr","FFC000"]),b(["accent5","srgbClr","5B9BD5"]),b(["accent6","srgbClr","70AD47"]),b(["hlink","srgbClr","0563C1"]),b(["folHlink","srgbClr","954F72"])]}},C=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},I=function(e){var t=C(e,4),r=t[0],n=t[1],o=t[2],a=t[3];return{name:"a:".concat(r),properties:{rawMap:{script:o,typeface:n,panose:a}}}},T=function(){var t=e._.utf8_encode;return{name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[I(["latin","Calibri Light",void 0,"020F0302020204030204"]),I(["ea",""]),I(["cs",""]),I(["font",t("\u6e38\u30b4\u30b7\u30c3\u30af Light"),"Jpan"]),I(["font",t("\ub9d1\uc740 \uace0\ub515"),"Hang"]),I(["font",t("\u7b49\u7ebf Light"),"Hans"]),I(["font",t("\u65b0\u7d30\u660e\u9ad4"),"Hant"]),I(["font","Times New Roman","Arab"]),I(["font","Times New Roman","Hebr"]),I(["font","Tahoma","Thai"]),I(["font","Nyala","Ethi"]),I(["font","Vrinda","Beng"]),I(["font","Shruti","Gujr"]),I(["font","MoolBoran","Khmr"]),I(["font","Tunga","Knda"]),I(["font","Raavi","Guru"]),I(["font","Euphemia","Cans"]),I(["font","Plantagenet Cherokee","Cher"]),I(["font","Microsoft Yi Baiti","Yiii"]),I(["font","Microsoft Himalaya","Tibt"]),I(["font","MV Boli","Thaa"]),I(["font","Mangal","Deva"]),I(["font","Gautami","Telu"]),I(["font","Latha","Taml"]),I(["font","Estrangelo Edessa","Syrc"]),I(["font","Kalinga","Orya"]),I(["font","Kartika","Mlym"]),I(["font","DokChampa","Laoo"]),I(["font","Iskoola Pota","Sinh"]),I(["font","Mongolian Baiti","Mong"]),I(["font","Times New Roman","Viet"]),I(["font","Microsoft Uighur","Uigh"]),I(["font","Sylfaen","Geor"]),I(["font","Arial","Armn"]),I(["font","Leelawadee UI","Bugi"]),I(["font","Microsoft JhengHei","Bopo"]),I(["font","Javanese Text","Java"]),I(["font","Segoe UI","Lisu"]),I(["font","Myanmar Text","Mymr"]),I(["font","Ebrima","Nkoo"]),I(["font","Nirmala UI","Olck"]),I(["font","Ebrima","Osma"]),I(["font","Phagspa","Phag"]),I(["font","Estrangelo Edessa","Syrn"]),I(["font","Estrangelo Edessa","Syrj"]),I(["font","Estrangelo Edessa","Syre"]),I(["font","Nirmala UI","Sora"]),I(["font","Microsoft Tai Le","Tale"]),I(["font","Microsoft New Tai Lue","Talu"]),I(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[I(["latin","Calibri",void 0,"020F0502020204030204"]),I(["ea",""]),I(["cs",""]),I(["font",t("\u6e38\u30b4\u30b7\u30c3\u30af"),"Jpan"]),I(["font",t("\ub9d1\uc740 \uace0\ub515"),"Hang"]),I(["font",t("\u7b49\u7ebf"),"Hans"]),I(["font",t("\u65b0\u7d30\u660e\u9ad4"),"Hant"]),I(["font","Arial","Arab"]),I(["font","Arial","Hebr"]),I(["font","Tahoma","Thai"]),I(["font","Nyala","Ethi"]),I(["font","Vrinda","Beng"]),I(["font","Shruti","Gujr"]),I(["font","DaunPenh","Khmr"]),I(["font","Tunga","Knda"]),I(["font","Raavi","Guru"]),I(["font","Euphemia","Cans"]),I(["font","Plantagenet Cherokee","Cher"]),I(["font","Microsoft Yi Baiti","Yiii"]),I(["font","Microsoft Himalaya","Tibt"]),I(["font","MV Boli","Thaa"]),I(["font","Mangal","Deva"]),I(["font","Gautami","Telu"]),I(["font","Latha","Taml"]),I(["font","Estrangelo Edessa","Syrc"]),I(["font","Kalinga","Orya"]),I(["font","Kartika","Mlym"]),I(["font","DokChampa","Laoo"]),I(["font","Iskoola Pota","Sinh"]),I(["font","Mongolian Baiti","Mong"]),I(["font","Arial","Viet"]),I(["font","Microsoft Uighur","Uigh"]),I(["font","Sylfaen","Geor"]),I(["font","Arial","Armn"]),I(["font","Leelawadee UI","Bugi"]),I(["font","Microsoft JhengHei","Bopo"]),I(["font","Javanese Text","Java"]),I(["font","Segoe UI","Lisu"]),I(["font","Myanmar Text","Mymr"]),I(["font","Ebrima","Nkoo"]),I(["font","Nirmala UI","Olck"]),I(["font","Ebrima","Osma"]),I(["font","Phagspa","Phag"]),I(["font","Estrangelo Edessa","Syrn"]),I(["font","Estrangelo Edessa","Syrj"]),I(["font","Estrangelo Edessa","Syre"]),I(["font","Nirmala UI","Sora"]),I(["font","Microsoft Tai Le","Tale"]),I(["font","Microsoft New Tai Lue","Talu"]),I(["font","Ebrima","Tfng"])]}]}},E=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},D=function(e,t,r){return{name:"a:".concat(e),properties:{rawMap:{val:t}},children:r}},k=function(e){var t=E(e,6),r=t[0],n=t[1],o=t[2],a=t[3],i=t[4],l=t[5],s=[];return s.push(D("satMod",o)),a&&s.push(D("lumMod",a)),i&&s.push(D("tint",i)),l&&s.push(D("shade",l)),{name:"a:gs",properties:{rawMap:{pos:r}},children:[{name:"a:schemeClr",properties:{rawMap:{val:n}},children:s}]}},F=function(e,t){return{name:"a:solidFill",children:[D("schemeClr",e,t)]}},A=function(e){var t=E(e,5),r=t[0],n=t[1],o=t[2],a=t[3],i=t[4],l=E(i,2),s=l[0],c=l[1];return{name:"a:gradFill",properties:{rawMap:{rotWithShape:r}},children:[{name:"a:gsLst",children:[k(n),k(o),k(a)]},{name:"a:lin",properties:{rawMap:{ang:s,scaled:c}}}]}},N=function(e){var t=E(e,4);return{name:"a:ln",properties:{rawMap:{w:t[0],cap:t[1],cmpd:t[2],algn:t[3]}},children:[F("phClr"),D("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},O=function(e){var t=[];if(e){var r=E(e,5),n=r[0],o=r[1],a=r[2],i=r[3],l=r[4];t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:n,dist:o,dir:a,algn:i,rotWithShape:l}},children:[D("srgbClr","000000",[D("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},P=function(){return{name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:fillStyleLst",children:[F("phClr"),A(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),A(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]},{name:"a:lnStyleLst",children:[N(["6350","flat","sng","ctr"]),N(["12700","flat","sng","ctr"]),N(["19050","flat","sng","ctr"])]},{name:"a:effectStyleLst",children:[O(),O(),O(["57150","19050","5400000","ctr","0"])]},{name:"a:bgFillStyleLst",children:[F("phClr"),F("phClr",[D("tint","95000"),D("satMod","170000")]),A(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}]}},R=function(){return{name:"a:themeElements",children:[M(),T(),P()]}},L=function(){return{name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[R(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]}},_=function(t){return{name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:t.size,uniqueCount:t.size}},children:(r=t,n=[],r.forEach((function(t,r){var o=r.toString(),a={name:"t",textNode:e._.utf8_encode(e._.escapeString(o))};o.trim().length!==o.length&&(a.properties={rawMap:{"xml:space":"preserve"}}),n.push({name:"si",children:[a]})})),n)};var r,n};var B,H,z,G,j,W,U,V,Z,J,X=function(t){var r=t.formatCode,n=t.numFmtId;return r.length&&(r=function(t){for(var r=t.split(/(\[[^\]]*\])/),n=0;n<r.length;n++){var o=r[n];o.length&&(o.startsWith("[")||(o=o.replace(/\$/g,'"$"')),r[n]=e._.escapeString(o))}return r.join("")}(r)),{name:"numFmt",properties:{rawMap:{formatCode:r,numFmtId:n}}}},K=function(e){return{name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map((function(e){return X(e)}))}},Y=function(e){var t=e.size,r=e.colorTheme,n=e.color,o=void 0===n?"FF000000":n,a=e.fontName,i=void 0===a?"Calibri":a,l=e.family,s=e.scheme,c=e.italic,p=e.bold,u=e.strikeThrough,d=e.outline,f=e.shadow,h=e.underline,m=e.verticalAlign,g=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:r,rgb:o}}},{name:"name",properties:{rawMap:{val:i}}}];return l&&g.push({name:"family",properties:{rawMap:{val:l}}}),s&&g.push({name:"scheme",properties:{rawMap:{val:s}}}),c&&g.push({name:"i"}),p&&g.push({name:"b"}),u&&g.push({name:"strike"}),d&&g.push({name:"outline"}),f&&g.push({name:"shadow"}),h&&g.push({name:"u",properties:{rawMap:{val:h}}}),m&&g.push({name:"vertAlign",properties:{rawMap:{val:m}}}),{name:"font",children:g}},q=function(e){return{name:"fonts",properties:{rawMap:{count:e.length}},children:e.map((function(e){return Y(e)}))}},$=function(e){var t=e.patternType,r=e.fgTheme,n=e.fgTint,o=e.fgRgb,a=e.bgRgb,i=e.bgIndexed,l={name:"patternFill",properties:{rawMap:{patternType:t}}};return(r||n||o)&&(l.children=[{name:"fgColor",properties:{rawMap:{theme:r,tint:n,rgb:o}}}]),(i||a)&&(l.children||(l.children=[]),l.children.push({name:"bgColor",properties:{rawMap:{indexed:i,rgb:a}}})),{name:"fill",children:[l]}},Q=function(e){return{name:"fills",properties:{rawMap:{count:e.length}},children:e.map((function(e){return $(e)}))}},ee={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot"},te=["Dashed","DashDot","DashDotDot"],re={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},ne={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},oe={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},ae=function(e){return null==e?e:("#"===e.charAt(0)&&(e=e.substring(1)),6===e.length?"FF"+e:e)},ie=function(e,t){if(!e)return"thin";var r=function(e){switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}}(t),n=ee[e];return"Continuous"===e?r:"medium"===r&&-1!==te.indexOf(n)?"medium".concat(n):n.charAt(0).toLowerCase()+n.substring(1)},le=function(e){return ne[e]||"general"},se=function(e){return oe[e]||void 0},ce=function(e){return{name:"color",properties:{rawMap:{rgb:ae(e||"#000000")}}}},pe=function(e){var t=e.left,r=e.right,n=e.top,o=e.bottom,a=e.diagonal,i=t?[ce(t.color)]:void 0,l=r?[ce(r.color)]:void 0,s=n?[ce(n.color)]:void 0,c=o?[ce(o.color)]:void 0,p=a?[ce(a.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:i},{name:"right",properties:{rawMap:{style:r&&r.style}},children:l},{name:"top",properties:{rawMap:{style:n&&n.style}},children:s},{name:"bottom",properties:{rawMap:{style:o&&o.style}},children:c},{name:"diagonal",properties:{rawMap:{style:a&&a.style}},children:p}]}},ue=function(e){return{name:"borders",properties:{rawMap:{count:e.length}},children:e.map((function(e){return pe(e)}))}},de=function(e){var t=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(t,0)},fe=function(e){var t=e.horizontal,r=e.indent,n=e.readingOrder,o=e.rotate,a=e.shrinkToFit,i=e.vertical,l=e.wrapText;return{name:"alignment",properties:{rawMap:{horizontal:t&&le(t),indent:r,readingOrder:n&&de(n),textRotation:o,shrinkToFit:a,vertical:i&&se(i),wrapText:l}}}},he=function(e){var t=!1===e.protected?0:1;return{name:"protection",properties:{rawMap:{hidden:!0===e.hideFormula?1:0,locked:t}}}},me=function(e){var t=e.alignment,r=e.borderId,n=e.fillId,o=e.fontId,a=e.numFmtId,i=e.protection,l=e.xfId,s=[];return t&&s.push(fe(t)),i&&s.push(he(i)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:i?1:void 0,applyBorder:r?1:void 0,applyFill:n?1:void 0,borderId:r,fillId:n,applyFont:o?1:void 0,fontId:o,applyNumberFormat:a?1:void 0,numFmtId:a,xfId:l}},children:s.length?s:void 0}},ge=function(e){return{name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map((function(e){return me(e)}))}},ye=function(e){return{name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map((function(e){return me(e)}))}},ve=function(e){return{name:"cellStyle",properties:{rawMap:{builtinId:e.builtinId,name:e.name,xfId:e.xfId}}}},we=function(e){return{name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map((function(e){return ve(e)}))}},xe=function(){return(xe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Se=function(e,t){return-1!==e.indexOf("mixedStyle")&&t>1&&(e+="_".concat(t)),e},be=function(){B={base:0},H=[],z=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],G=[{patternType:"none"},{patternType:"gray125"}],j=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],W=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],U=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],V=[{builtinId:0,name:"Normal",xfId:0}]},Me=function(e){var t,r=(t=e.pattern)?re[t]||t:"none",n=ae(e.color),o=ae(e.patternColor),a=G.findIndex((function(e){var t=e.patternType,a=e.fgRgb,i=e.bgRgb;return t==r&&a==n&&i==o}));return-1===a&&(a=G.length,G.push({patternType:r,fgRgb:n,bgRgb:o})),a},Ce=function(t){var r=t.fontName,n=void 0===r?"Calibri":r,o=t.color,a=t.size,i=t.bold,l=t.italic,s=t.outline,c=t.shadow,p=t.strikeThrough,u=t.underline,d=t.family,f=t.verticalAlign,h=n?e._.utf8_encode(n):n,m=ae(o),g=function(e){if(void 0!==e){var t=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(t,0)}}(d),y=u?u.toLocaleLowerCase():void 0,v=f?f.toLocaleLowerCase():void 0,w=z.findIndex((function(e){return e.fontName==h&&e.color==m&&e.size==a&&e.bold==i&&e.italic==l&&e.outline==s&&e.shadow==c&&e.strikeThrough==p&&e.underline==y&&e.verticalAlign==v&&e.family==g}));return-1===w&&(w=z.length,z.push({fontName:h,color:m,size:a,bold:i,italic:l,outline:s,shadow:c,strikeThrough:p,underline:y,verticalAlign:v,family:null!=g?g.toString():void 0})),w},Ie=function(t){var r=t.alignment,n=t.borders,o=t.font,a=t.interior,i=t.numberFormat,l=t.protection,c=t.id,p=0,u=0,d=0,f=0;c&&(c=Se(c,Z),null==B[c]&&(a&&(p=Me(a)),n&&(u=function(e){var t,r,n,o,a,i,l,s,c=e.borderBottom,p=e.borderTop,u=e.borderLeft,d=e.borderRight;u&&(n=ie(u.lineStyle,u.weight),l=ae(u.color)),d&&(o=ie(d.lineStyle,d.weight),s=ae(d.color)),c&&(t=ie(c.lineStyle,c.weight),a=ae(c.color)),p&&(r=ie(p.lineStyle,p.weight),i=ae(p.color));var f=j.findIndex((function(e){var c=e.left,p=e.right,u=e.top,d=e.bottom;if(!c&&(n||l))return!1;if(!p&&(o||s))return!1;if(!u&&(r||i))return!1;if(!d&&(t||a))return!1;var f=c||{},h=f.style,m=f.color,g=p||{},y=g.style,v=g.color,w=u||{},x=w.style,S=w.color,b=d||{},M=b.style,C=b.color;return h==n&&m==l&&(y==o&&v==s&&(x==r&&S==i&&(M==t&&C==a)))}));return-1===f&&(f=j.length,j.push({left:{style:n,color:l},right:{style:o,color:s},top:{style:r,color:i},bottom:{style:t,color:a},diagonal:{style:void 0,color:void 0}})),f}(n)),o&&(d=Ce(o)),i&&(f=function(t){if(t=e._.utf8_encode(t),s[t])return s[t];var r=H.findIndex((function(e){return e.formatCode===t}));return-1===r?(r=H.length+164,H.push({formatCode:t,numFmtId:r})):r=H[r].numFmtId,r}(i.format)),B[c]=U.length,U.push({alignment:r,borderId:u||0,fillId:p||0,fontId:d||0,numFmtId:f||0,protection:l,xfId:0})))},Te=function(e){var t=K(H),r=q(z.map((function(t){return xe(xe({},t),{size:null!=t.size?t.size:e})}))),n=Q(G),o=ue(j),a=ge(W),i=ye(U),l=we(V);return be(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,r,n,o,a,i,l,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}},Ee=function(e,t){return B[Se(e,t)]||0},De=function(e,t){var r=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:r,"r:id":"rId".concat(r)}}}},ke=function(e){return{name:"sheets",children:e.map((function(e,t){return De(e,t)}))}},Fe=function(e){return{name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[ke(e)]}},Ae=function(e){var t=e.min,r=e.max,n=e.outlineLevel,o=e.s,a=e.width,i=e.hidden,l=e.bestFit,s=1,c="0";return a>1&&(s=function(e){return Math.ceil((e-12)/7+1)}(a),c="1"),{name:"col",properties:{rawMap:{min:t,max:r,outlineLevel:null!=n?n:void 0,width:s,style:o,hidden:i?"1":"0",bestFit:l?"1":"0",customWidth:c}}}},Ne=function(t,r,n){var o=t.ref,a=t.data,i=t.styleId,l=a||{type:"empty",value:null},s=l.type,c=l.value,p=s;"f"===s?p="str":s.charAt(0)===s.charAt(0).toUpperCase()&&(p=function(e){var t=e.charAt(0).toLowerCase();return"s"===t?"inlineStr":t}(s));var u,d={name:"c",properties:{rawMap:{r:o,t:"empty"===p?void 0:p,s:i?Ee(i,n):void 0}}};return"empty"===p?d:(u="str"===p&&"f"===s?[{name:"f",textNode:e._.escapeString(e._.utf8_encode(c))}]:"inlineStr"===p?[{name:"is",children:[{name:"t",textNode:e._.escapeString(e._.utf8_encode(c))}]}]:[{name:"v",textNode:c}],Object.assign({},d,{children:u}))},Oe=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},Pe=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Re=function(e){var t;return""!==(null===(t=e.data)||void 0===t?void 0:t.value)||void 0!==e.styleId},Le=function(e,t,r){var n=e.collapsed,o=e.hidden,a=e.height,i=e.outlineLevel,l=e.cells,s=void 0===l?[]:l;return function(e,t){for(var r=[],n=0,o=0;o<e.length;o++){(i=e[o]).mergeAcross&&(r.push({pos:o,excelPos:n}),n+=i.mergeAcross),n++}if(r.length)for(o=r.length-1;o>=0;o--){for(var a=[],i=e[r[o].pos],l=1;l<=i.mergeAcross;l++)a.push({ref:"".concat(d(r[o].excelPos+1+l)).concat(t+1),styleId:i.styleId,data:{type:"empty",value:null}});a.length&&e.splice.apply(e,Pe([r[o].pos+1,0],Oe(a),!1))}}(s,t),{name:"row",properties:{rawMap:{r:t+1,collapsed:n?"1":"0",hidden:o?"1":"0",ht:a,customHeight:null!=a?"1":"0",spans:"1:1",outlineLevel:i||void 0}},children:s.filter(Re).map((function(e,t){return Ne(e,t,r)}))}},_e=function(e){return{name:"mergeCell",properties:{rawMap:{ref:e}}}},Be=function(e){if(null==e)return 1;var t=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return-1===t?1:t+1},He=function(t){return t.reduce((function(t,r){var n,o,a,i,l="Center"===(n=r.position)?"C":"Right"===n?"R":"L",s=(o="".concat(t,"&amp;").concat(l),(a=r.font)?(o+="&amp;&quot;",o+=a.fontName||"Calibri",a.bold!==a.italic?o+=a.bold?",Bold":",Italic":a.bold?o+=",Bold Italic":o+=",Regular",o+="&quot;",a.size&&(o+="&amp;".concat(a.size)),a.strikeThrough&&(o+="&amp;S"),a.underline&&(o+="&amp;".concat("Double"===a.underline?"E":"U")),a.color&&(o+="&amp;K".concat(a.color.replace("#","").toUpperCase())),o):o);return"".concat(s).concat(e._.escapeString(e._.utf8_encode((i=r.value,e._.iterateObject({"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F"},(function(e,t){i=i.replace(e,t)})),i))))}),"")},ze=function(t){var r=[];return["all","first","even"].forEach((function(n){var o=t[n],a="all"===n?"odd":n;o&&(o.header||o.footer)&&e._.iterateObject(o,(function(e,t){var n="".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));t&&r.push({name:"".concat(a).concat(n),properties:{rawMap:{"xml:space":"preserve"}},textNode:He(t)})}))})),r},Ge=function(t){var r,n=t.worksheet,o=t.currentSheet,a=t.config,i=a.margins,l=void 0===i?{}:i,s=a.pageSetup,c=a.headerFooterConfig,p=a.suppressColumnOutline,u=n.table,f=u.rows,h=u.columns,m=h&&h.length?function(e,t,r){var n=[],o=[];e.forEach((function(e,r){var a,i=e.cells,l=0;i.forEach((function(e,i){var s=i+l+1,c=d(s),p=r+1;if(e.mergeAcross){l+=e.mergeAcross;var u=d(i+l+1);n.push("".concat(c).concat(p,":").concat(u).concat(p))}t[s-1]||(t[s-1]={});var f=e.collapsibleRanges;f&&f.forEach((function(e){o.push([s+e[0],s+e[1]])})),(a=t[s-1]).min=s,a.max=s,e.ref="".concat(c).concat(p)}))})),o.sort((function(e,t){return e[0]!==t[0]?e[0]-t[0]:t[1]-e[1]}));var a=new Map,i=new Map;return o.filter((function(e){var t=e.toString();return!a.get(t)&&(a.set(t,!0),!0)})).forEach((function(e){var n=t.find((function(t){return t.min==e[0]&&t.max==e[1]})),o=i.get(e[0]);t.push({min:e[0],max:e[1],outlineLevel:r?void 0:o||1,width:(n||{width:100}).width}),i.set(e[0],(o||0)+1)})),n}(f,h,!!p):[];return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:e._.compose((function(e){return e.push({name:"sheetPr",children:[{name:"outlinePr",properties:{rawMap:{summaryBelow:0}}}]}),e}),function(e){return function(t){var r=e.reduce((function(e,t){return t.outlineLevel&&t.outlineLevel>e?t.outlineLevel:e}),0);return t.push({name:"sheetFormatPr",properties:{rawMap:{baseColWidth:10,defaultRowHeight:16,outlineLevelRow:r||void 0}}}),t}}(f),function(e){return function(t){return e.length&&t.push({name:"cols",children:e.map((function(e){return Ae(e)}))}),t}}(h),function(e,t){return function(r){return e.length&&r.push({name:"sheetData",children:e.map((function(e,r){return Le(e,r,t)}))}),r}}(f,o+1),(r=m,function(e){return r.length&&e.push({name:"mergeCells",properties:{rawMap:{count:r.length}},children:r.map((function(e){return _e(e)}))}),e}),function(e){return function(t){var r=e.top,n=void 0===r?.75:r,o=e.right,a=void 0===o?.7:o,i=e.bottom,l=void 0===i?.75:i,s=e.left,c=void 0===s?.7:s,p=e.header,u=void 0===p?.3:p,d=e.footer,f=void 0===d?.3:d;return t.push({name:"pageMargins",properties:{rawMap:{bottom:l,footer:f,header:u,left:c,right:a,top:n}}}),t}}(l),function(e){return function(t){var r;return e&&t.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:(r=e.orientation,!r||"Portrait"!==r&&"Landscape"!==r?"portrait":r.toLocaleLowerCase()),paperSize:Be(e.pageSize)}}}),t}}(s),function(e){return function(t){if(!e)return t;var r=null!=e.first?1:0,n=null!=e.even?1:0;return t.push({name:"headerFooter",properties:{rawMap:{differentFirst:r,differentOddEven:n}},children:ze(e)}),t}}(c),function(e){return function(t){return Ze.worksheetImages.get(e)&&t.push({name:"drawing",properties:{rawMap:{"r:id":"rId1"}}}),t}}(o))([])}},je=function(e){return{name:"Relationship",properties:{rawMap:{Id:e.Id,Type:e.Type,Target:e.Target}}}},We=function(e){return{name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:e.map((function(e){return je(e)}))}},Ue=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},Ve=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Ze=function(){function t(){}return t.createExcel=function(e,t,r){return this.addSheetName(t),function(e,t){1===(Z=t)&&be(),e.forEach(Ie)}(e,this.sheetNames.length),this.createWorksheet(t,r)},t.buildImageMap=function(e,t,r,n,o){var a=this.sheetNames.length,i=this.images.get(e.id);e.position&&e.position.row&&e.position.column||(e.position||(e.position={}),e.position=Object.assign({},e.position,{row:t,column:n.indexOf(r)+1}));var l=e;if(function(e,t){var r=e.position,n=r.colSpan,o=r.column;if(e.width)if(n)for(var a=t.slice(o-1,o+n-1),i=0,l=0;l<a.length;l++){var s=a[l].getActualWidth();if(e.width<i+s){e.position.colSpan=l+1,e.totalWidth=e.width,e.width=e.totalWidth-i;break}i+=s}else e.totalWidth=e.width}(l,n),function(e,t){var r,n=e.position,o=n.rowSpan,a=n.row;if(e.height)if(o)for(var i=0,l=0,s=a;s<a+o;s++){var c=(r=p(s,t)||20,Math.round(96*r/72));if(e.height<i+c){e.position.rowSpan=l+1,e.totalHeight=e.height,e.height=e.totalHeight-i;break}i+=c,l++}else e.totalHeight=e.height}(l,o),i){var s=i.find((function(e){return e.sheetId===a}));s?s.image.push(l):i.push({sheetId:a,image:[l]})}else this.images.set(l.id,[{sheetId:a,image:[l]}]),this.workbookImageIds.set(l.id,{type:l.imageType,index:this.workbookImageIds.size});this.buildSheetImageMap(a,l)},t.buildSheetImageMap=function(e,t){var r=this.worksheetImageIds.get(e);r||(r=new Map,this.worksheetImageIds.set(e,r));var n=this.worksheetImages.get(e);n?(n.push(t),r.get(t.id)||r.set(t.id,{index:r.size,type:t.imageType})):(this.worksheetImages.set(e,[t]),r.set(t.id,{index:0,type:t.imageType}))},t.addSheetName=function(t){for(var r=e._.escapeString(t.name)||"",n="";-1!==this.sheetNames.indexOf("".concat(r).concat(n));)if(""===n)n="_1";else{var o=parseInt(n.slice(1),10);n="_".concat(o+1)}t.name="".concat(r).concat(n),this.sheetNames.push(t.name)},t.getStringPosition=function(e){return this.sharedStrings.has(e)?this.sharedStrings.get(e):(this.sharedStrings.set(e,this.sharedStrings.size),this.sharedStrings.size-1)},t.resetFactory=function(){this.sharedStrings=new Map,this.images=new Map,this.worksheetImages=new Map,this.workbookImageIds=new Map,this.worksheetImageIds=new Map,this.sheetNames=[],this.factoryMode=e.ExcelFactoryMode.SINGLE_SHEET},t.createWorkbook=function(){return u(Fe(this.sheetNames))},t.createStylesheet=function(e){return u(Te(e))},t.createSharedStrings=function(){return u(_(this.sharedStrings))},t.createCore=function(e){return u(n(e))},t.createContentTypes=function(e){return u(l(e))},t.createRels=function(){var e=We([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return u(e)},t.createTheme=function(){return u(L())},t.createWorkbookRels=function(e){var t=new Array(e).fill(void 0).map((function(e,t){return{Id:"rId".concat(t+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:"worksheets/sheet".concat(t+1,".xml")}})),r=We(Ve(Ve([],Ue(t),!1),[{Id:"rId".concat(e+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:"rId".concat(e+2),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:"rId".concat(e+3),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}],!1));return u(r)},t.createDrawing=function(e){return u(x({sheetIndex:e}))},t.createDrawingRel=function(e){var t=this,r=this.worksheetImageIds.get(e),n=[];return r.forEach((function(e,r){n.push({Id:"rId".concat(e.index+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:"../media/image".concat(t.workbookImageIds.get(r).index+1,".").concat(e.type)})})),u(We(n))},t.createWorksheetDrawingRel=function(e){var t=We([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:"../drawings/drawing".concat(e+1,".xml")}]);return u(t)},t.createWorksheet=function(e,t){return u(Ge({worksheet:e,currentSheet:this.sheetNames.length-1,config:t}))},t.sharedStrings=new Map,t.sheetNames=[],t.images=new Map,t.worksheetImages=new Map,t.workbookImageIds=new Map,t.worksheetImageIds=new Map,t.factoryMode=e.ExcelFactoryMode.SINGLE_SHEET,t}(),Je=(J=function(e,t){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}J(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Xe=function(){return(Xe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ke=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},Ye=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},qe=function(t){function n(e){var r=t.call(this,e)||this;return r.mixedStyles={},r.mixedStyleCounter=0,r.rows=[],r.config=Object.assign({},e),r.stylesByIds={},r.config.baseExcelStyles.forEach((function(e){r.stylesByIds[e.id]=e})),r.excelStyles=Ye([],Ke(r.config.baseExcelStyles),!1),r}return Je(n,t),n.prototype.addCustomContent=function(e){var t=this;e.forEach((function(e){var r,n=t.rows.length+1;t.config.suppressRowOutline||null==e.outlineLevel||(r=e.outlineLevel);var o={height:p(n,e.height||t.config.rowHeight),cells:(e.cells||[]).map((function(e,r){var o,a,i,l=t.addImage(n,t.columnsToExport[r],null===(o=e.data)||void 0===o?void 0:o.value),s=null;e.styleId&&(s="string"==typeof e.styleId?[e.styleId]:e.styleId);var c=t.getStyleId(s);if(l)return t.createCell(c,t.getDataTypeForValue(l.value),null==l.value?"":l.value);var p=null!==(i=null===(a=e.data)||void 0===a?void 0:a.value)&&void 0!==i?i:"",u=t.getDataTypeForValue(p);return e.mergeAcross?t.createMergedCell(c,u,p,e.mergeAcross):t.createCell(c,u,p)})),outlineLevel:r};null!=e.collapsed&&(o.collapsed=e.collapsed),null!=e.hidden&&(o.hidden=e.hidden),t.rows.push(o)}))},n.prototype.onNewHeaderGroupingRow=function(){var e=this,t=[];return this.rows.push({cells:t,height:p(this.rows.length+1,this.config.headerRowHeight)}),{onColumn:function(n,o,a,i,l){var s=e.config.styleLinker({rowType:r.RowType.HEADER_GROUPING,rowIndex:1,value:"grouping-".concat(o),columnGroup:n});t.push(Xe(Xe({},e.createMergedCell(e.getStyleId(s),e.getDataTypeForValue("string"),o,i)),{collapsibleRanges:l}))}}},n.prototype.onNewHeaderRow=function(){return this.onNewRow(this.onNewHeaderColumn,this.config.headerRowHeight)},n.prototype.onNewBodyRow=function(e){var t=this.onNewRow(this.onNewBodyColumn,this.config.rowHeight);return e&&this.addRowOutlineIfNecessary(e),t},n.prototype.prepare=function(e){var r=this;t.prototype.prepare.call(this,e),this.columnsToExport=Ye([],Ke(e),!1),this.cols=e.map((function(e,t){return r.convertColumnToExcel(e,t)}))},n.prototype.parse=function(){for(var e=this.rows.reduce((function(e,t){return Math.max(e,t.cells.length)}),0);this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));var t={name:this.config.sheetName,table:{columns:this.cols,rows:this.rows}};return this.createExcel(t)},n.prototype.addRowOutlineIfNecessary=function(t){var r=this.config,n=r.gridOptionsService,o=r.suppressRowOutline,a=r.rowGroupExpandState,i=void 0===a?"expanded":a;if(!n.get("groupHideOpenParents")&&!o&&null!=t.level){var l=t.footer?1:0,s=e._.last(this.rows);if(s.outlineLevel=t.level+l,"expanded"!==i){var c="collapsed"===i;if(t.isExpandable()){var p=!c&&t.expanded;s.collapsed=!p}s.hidden=!!t.parent&&-1!==t.parent.level&&(c||this.isAnyParentCollapsed(t.parent))}}},n.prototype.isAnyParentCollapsed=function(e){for(;e&&-1!==e.level;){if(!e.expanded)return!0;e=e.parent}return!1},n.prototype.convertColumnToExcel=function(e,t){var r=this.config.columnWidth;if(r)return"number"==typeof r?{width:r}:{width:r({column:e,index:t})};if(e){return{width:Math.max(e.getActualWidth(),75)}}return{}},n.prototype.onNewHeaderColumn=function(e,t){var n=this;return function(o,a){var i=n.extractHeaderValue(o),l=n.config.styleLinker({rowType:r.RowType.HEADER,rowIndex:e,value:i,column:o});t.push(n.createCell(n.getStyleId(l),n.getDataTypeForValue("string"),i))}},n.prototype.onNewBodyColumn=function(e,t){var n=this,o=0;return function(a,i,l){if(o>0)o-=1;else{var s=n.extractRowCellValue(a,i,e,"excel",l),c=s.value,p=s.valueFormatted,u=n.config.styleLinker({rowType:r.RowType.BODY,rowIndex:e,value:c,column:a,node:l}),d=n.getStyleId(u),f=a.getColSpan(l),h=n.addImage(e,a,c);h?t.push(n.createCell(d,n.getDataTypeForValue(h.value),null==h.value?"":h.value)):f>1?(o=f-1,t.push(n.createMergedCell(d,n.getDataTypeForValue(c),c,f-1))):t.push(n.createCell(d,n.getDataTypeForValue(c),c,p))}}},n.prototype.onNewRow=function(e,t){var r=[];return this.rows.push({cells:r,height:p(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,r)()}},n.prototype.createExcel=function(e){var t=this.excelStyles,r=this.config;return Ze.createExcel(t,e,r)},n.prototype.getDataTypeForValue=function(e){return void 0===e?"empty":this.isNumerical(e)?"n":"s"},n.prototype.getType=function(e,t,r){if(this.isFormula(r))return"f";if(t&&t.dataType)switch(t.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:console.warn("AG Grid: Unrecognized data type for excel export [".concat(t.id,".dataType=").concat(t.dataType,"]"))}return e},n.prototype.addImage=function(e,t,r){if(this.config.addImageToCell){var n=this.config.addImageToCell(e,t,r);if(n)return Ze.buildImageMap(n.image,e,t,this.columnsToExport,this.config.rowHeight),n}},n.prototype.createCell=function(e,t,r,n){var o=this.getStyleById(e);!(null==o?void 0:o.dataType)&&"s"===t&&n&&(r=n);var a=this.getType(t,o,r)||t;return{styleId:o?e:void 0,data:{type:a,value:this.getCellValue(a,r)}}},n.prototype.createMergedCell=function(e,t,r,n){var o=null==r?"":r;return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:"s"===t?Ze.getStringPosition(o).toString():r},mergeAcross:n}},n.prototype.getCellValue=function(e,t){if(null==t)return Ze.getStringPosition("").toString();switch(e){case"s":return""===t?"":Ze.getStringPosition(t).toString();case"f":return t.slice(1);case"n":return Number(t).toString();default:return t}},n.prototype.getStyleId=function(e){if(!e||!e.length)return null;if(1===e.length)return e[0];var t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID},n.prototype.addNewMixedStyle=function(t){var r=this;this.mixedStyleCounter+=1;var n="mixedStyle".concat(this.mixedStyleCounter),o={};t.forEach((function(t){r.excelStyles.forEach((function(r){r.id===t&&e._.mergeDeep(o,e._.deepCloneObject(r))}))})),o.id=n,o.name=n;var a=t.join("-");this.mixedStyles[a]={excelID:n,key:a,result:o},this.excelStyles.push(o),this.stylesByIds[n]=o},n.prototype.isFormula=function(e){return null!=e&&(this.config.autoConvertFormulas&&e.toString().startsWith("="))},n.prototype.isNumerical=function(e){return"bigint"==typeof e||isFinite(e)&&""!==e&&!isNaN(parseFloat(e))},n.prototype.getStyleById=function(e){return null==e?null:this.stylesByIds[e]||null},n}(r.BaseGridSerializingSession),$e=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qe=function(){return(Qe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},et=function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},tt=function(e){var t=e.data,n=e.fontSize,o=void 0===n?11:n,a=e.author,i=void 0===a?"AG Grid":a,l=Ze.images.size>0;if(r.ZipContainer.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]),l){r.ZipContainer.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);var s=0;Ze.images.forEach((function(e){var t=e[0].image[0],n=t.imageType;r.ZipContainer.addFile("xl/media/image".concat(++s,".").concat(n),t.base64,!0)}))}if(!t||0===t.length)return console.warn("AG Grid: Invalid params supplied to getMultipleSheetsAsExcel() - `ExcelExportParams.data` is empty."),void Ze.resetFactory();var c=t.length,p=0;t.forEach((function(e,t){r.ZipContainer.addFile("xl/worksheets/sheet".concat(t+1,".xml"),e),l&&Ze.worksheetImages.get(t)&&nt(t,p++)})),r.ZipContainer.addFile("xl/workbook.xml",Ze.createWorkbook()),r.ZipContainer.addFile("xl/styles.xml",Ze.createStylesheet(o)),r.ZipContainer.addFile("xl/sharedStrings.xml",Ze.createSharedStrings()),r.ZipContainer.addFile("xl/theme/theme1.xml",Ze.createTheme()),r.ZipContainer.addFile("xl/_rels/workbook.xml.rels",Ze.createWorkbookRels(c)),r.ZipContainer.addFile("docProps/core.xml",Ze.createCore(i)),r.ZipContainer.addFile("[Content_Types].xml",Ze.createContentTypes(c)),r.ZipContainer.addFile("_rels/.rels",Ze.createRels()),Ze.resetFactory();var u=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return r.ZipContainer.getContent(u)},rt=function(e){var t=e.fileName,n=void 0===t?"export.xlsx":t,o=tt(e);o&&r.Downloader.download(n,o)},nt=function(e,t){var n="".concat("xl/drawings","/drawing").concat(t+1,".xml"),o="".concat("xl/drawings","/_rels/drawing").concat(t+1,".xml.rels"),a="xl/worksheets/_rels/sheet".concat(e+1,".xml.rels");r.ZipContainer.addFile(o,Ze.createDrawingRel(e)),r.ZipContainer.addFile(n,Ze.createDrawing(e)),r.ZipContainer.addFile(a,Ze.createWorksheetDrawingRel(t))},ot=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return $e(n,t),n.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})},n.prototype.getMergedParams=function(e){var t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({},t,e)},n.prototype.export=function(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var t=this.getMergedParams(e),n=this.getData(t),o={data:[n],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType},a=this.packageFile(o);return a&&r.Downloader.download(this.getFileName(t.fileName),a),n},n.prototype.exportDataAsExcel=function(e){return this.export(e)},n.prototype.getDataAsExcel=function(e){var t=this.getMergedParams(e),r={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(r)},n.prototype.setFactoryMode=function(e){Ze.factoryMode=e},n.prototype.getFactoryMode=function(){return Ze.factoryMode},n.prototype.getSheetDataForExcel=function(e){var t=this.getMergedParams(e);return this.getData(t)},n.prototype.getMultipleSheetsAsExcel=function(e){return tt(e)},n.prototype.exportMultipleSheetsAsExcel=function(e){return rt(e)},n.prototype.getDefaultFileExtension=function(){return"xlsx"},n.prototype.createSerializingSession=function(t){var r=this,n=r.columnModel,o=r.valueService,a=r.gridOptionsService,i=r.valueFormatterService,l=r.valueParserService,s="ag-grid";null!=t.sheetName&&(s=e._.utf8_encode(String(t.sheetName).substring(0,31)));var c=Qe(Qe({},t),{sheetName:s,columnModel:n,valueService:o,gridOptionsService:a,valueFormatterService:i,valueParserService:l,suppressRowOutline:t.suppressRowOutline||t.skipRowGroups,headerRowHeight:t.headerRowHeight||t.rowHeight,baseExcelStyles:this.gridOptionsService.get("excelStyles")||[],styleLinker:this.styleLinker.bind(this)});return new qe(c)},n.prototype.styleLinker=function(t){var n=t.rowType,o=t.rowIndex,a=t.value,i=t.column,l=t.columnGroup,s=t.node,c=n===r.RowType.HEADER,p=n===r.RowType.HEADER_GROUPING,u=c?i:l,d=[];if(c||p)return d.push("header"),p&&d.push("headerGroup"),u&&(d=d.concat(e.CssClassApplier.getHeaderClassesFromColDef(u.getDefinition(),this.gridOptionsService,i||null,l||null))),d;var f=this.gridOptionsService.get("excelStyles"),h=["cell"];if(!f||!f.length)return h;var m=f.map((function(e){return e.id}));return this.stylingService.processAllCellClasses(i.getDefinition(),{value:a,data:s.data,node:s,colDef:i.getDefinition(),column:i,rowIndex:o,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},(function(e){m.indexOf(e)>-1&&h.push(e)})),h.sort((function(e,t){return m.indexOf(e)<m.indexOf(t)?-1:1}))},n.prototype.isExportSuppressed=function(){return this.gridOptionsService.get("suppressExcelExport")},n.prototype.packageFile=function(e){return tt(e)},et([e.Autowired("columnModel")],n.prototype,"columnModel",void 0),et([e.Autowired("valueService")],n.prototype,"valueService",void 0),et([e.Autowired("stylingService")],n.prototype,"stylingService",void 0),et([e.Autowired("gridSerializer")],n.prototype,"gridSerializer",void 0),et([e.Autowired("gridOptionsService")],n.prototype,"gridOptionsService",void 0),et([e.Autowired("valueFormatterService")],n.prototype,"valueFormatterService",void 0),et([e.Autowired("valueParserService")],n.prototype,"valueParserService",void 0),et([e.PostConstruct],n.prototype,"postConstruct",null),n=et([e.Bean("excelCreator")],n)}(r.BaseCreator),at={version:"31.0.0",moduleName:e.ModuleNames.ExcelExportModule,beans:[ot,r.GridSerializer,r.CsvCreator],dependantModules:[r.CsvExportModule,t.EnterpriseCoreModule]};exports.ExcelExportModule=at,exports.exportMultipleSheetsAsExcel=rt,exports.getMultipleSheetsAsExcel=tt;