/**
          * @ag-grid-enterprise/multi-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v31.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/multi-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v31.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e=require("@ag-grid-community/core"),i=require("@ag-grid-enterprise/core"),n=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)},function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),r=function(){return(r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},o=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},s=function(t){function i(){var e=t.call(this,'<div class="ag-multi-filter ag-menu-list-compact"></div>')||this;return e.filterDefs=[],e.filters=[],e.guiDestroyFuncs=[],e.activeFilterIndices=[],e.lastActivatedMenuItem=null,e.afterFiltersReadyFuncs=[],e}return n(i,t),i.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onFocusIn:function(e){return t.onFocusIn(e)}})},i.getFilterDefs=function(t){var e=t.filters;return e&&e.length>0?e:[{filter:"agTextColumnFilter"},{filter:"agSetColumnFilter"}]},i.prototype.init=function(t){var n=this;this.params=t,this.filterDefs=i.getFilterDefs(t);var r=t.column,o=t.filterChangedCallback;this.column=r,this.filterChangedCallback=o;var s=[];return this.filterDefs.forEach((function(t,e){var i=n.createFilter(t,e);null!=i&&s.push(i)})),e.AgPromise.all(s).then((function(t){n.filters=t,n.refreshGui("columnMenu"),n.afterFiltersReadyFuncs.forEach((function(t){return t()})),n.afterFiltersReadyFuncs.length=0}))},i.prototype.refreshGui=function(t){var i=this;t!==this.lastOpenedInContainer&&(this.removeAllChildrenExceptTabGuards(),this.destroyChildren(),this.filters.forEach((function(n,r){r>0&&i.appendChild(e._.loadTemplate('<div class="ag-filter-separator"></div>'));var o,s=i.filterDefs[r],l=i.getFilterTitle(n,s);if("subMenu"===s.display&&"toolPanel"!==t)o=i.insertFilterMenu(n,l).getGui();else if("subMenu"===s.display||"accordion"===s.display){o=i.insertFilterGroup(n,l).getGui()}else o=n.getGui();i.appendChild(o)})),this.lastOpenedInContainer=t)},i.prototype.getFilterTitle=function(t,e){if(null!=e.title)return e.title;var i=t;return"function"==typeof i.getFilterTitle?i.getFilterTitle():"Filter"},i.prototype.destroyChildren=function(){this.guiDestroyFuncs.forEach((function(t){return t()})),this.guiDestroyFuncs.length=0},i.prototype.insertFilterMenu=function(t,i){var n=this,r=this.createBean(new e.AgMenuItemComponent({name:i,subMenu:t,cssClasses:["ag-multi-filter-menu-item"],isCompact:!0,isAnotherSubMenuOpen:function(){return!1}}));return r.setParentComponent(this),this.guiDestroyFuncs.push((function(){return n.destroyBean(r)})),this.addManagedListener(r,e.AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED,(function(t){n.lastActivatedMenuItem&&n.lastActivatedMenuItem!==t.menuItem&&n.lastActivatedMenuItem.deactivate(),n.lastActivatedMenuItem=t.menuItem})),r.addGuiEventListener("focusin",(function(){return r.activate()})),r.addGuiEventListener("focusout",(function(){r.isSubMenuOpen()||r.deactivate()})),r},i.prototype.insertFilterGroup=function(t,i){var n=this,r=this.createBean(new e.AgGroupComponent({title:i,cssIdentifier:"multi-filter"}));return this.guiDestroyFuncs.push((function(){return n.destroyBean(r)})),r.addItem(t.getGui()),r.toggleGroupExpand(!1),t.afterGuiAttached&&r.addManagedListener(r,e.AgGroupComponent.EVENT_EXPANDED,(function(){return t.afterGuiAttached({container:n.lastOpenedInContainer,suppressFocus:!0,hidePopup:n.hidePopup})})),r},i.prototype.isFilterActive=function(){return this.filters.some((function(t){return t.isFilterActive()}))},i.prototype.getLastActiveFilterIndex=function(){return this.activeFilterIndices.length>0?this.activeFilterIndices[this.activeFilterIndices.length-1]:null},i.prototype.doesFilterPass=function(t,e){var i=!0;return this.filters.forEach((function(n){i&&n!==e&&n.isFilterActive()&&(i=n.doesFilterPass(t))})),i},i.prototype.getFilterType=function(){return"multi"},i.prototype.getModelFromUi=function(){return{filterType:this.getFilterType(),filterModels:this.filters.map((function(t){var e=t;return"function"==typeof e.getModelFromUi?e.getModelFromUi():null}))}},i.prototype.getModel=function(){return this.isFilterActive()?{filterType:this.getFilterType(),filterModels:this.filters.map((function(t){return t.isFilterActive()?t.getModel():null}))}:null},i.prototype.setModel=function(t){var i=this,n=function(t,i){return new e.AgPromise((function(e){var n=t.setModel(i);n?n.then((function(){return e()})):e()}))},r=[];return null==t?r=this.filters.map((function(t,e){return n(t,null).then((function(){i.updateActiveList(e)}))})):this.filters.forEach((function(e,o){var s=t.filterModels.length>o?t.filterModels[o]:null,l=n(e,s).then((function(){i.updateActiveList(o)}));r.push(l)})),e.AgPromise.all(r).then((function(){}))},i.prototype.applyModel=function(t){void 0===t&&(t="api");var i=!1;return this.filters.forEach((function(n){n instanceof e.ProvidedFilter&&(i=n.applyModel(t)||i)})),i},i.prototype.getChildFilterInstance=function(t){return this.filters[t]},i.prototype.afterGuiAttached=function(t){t?(this.hidePopup=t.hidePopup,this.refreshGui(t.container)):this.hidePopup=void 0;var e=this.params.filters,i=e&&e.some((function(t){return t.display&&"inline"!==t.display}));this.executeFunctionIfExists("afterGuiAttached",r(r({},t||{}),{suppressFocus:i}));var n=this.gridOptionsService.getDocument(),o=n.activeElement;i&&(o===n.body||this.getGui().contains(o))&&this.forceFocusOutOfContainer(!0)},i.prototype.afterGuiDetached=function(){this.executeFunctionIfExists("afterGuiDetached")},i.prototype.onAnyFilterChanged=function(){this.executeFunctionIfExists("onAnyFilterChanged")},i.prototype.onNewRowsLoaded=function(){this.executeFunctionIfExists("onNewRowsLoaded")},i.prototype.destroy=function(){var e=this;this.filters.forEach((function(t){t.setModel(null),e.destroyBean(t)})),this.filters.length=0,this.destroyChildren(),this.hidePopup=void 0,t.prototype.destroy.call(this)},i.prototype.executeFunctionIfExists=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];e._.forEachReverse(this.filters,(function(e){var n=e[t];"function"==typeof n&&n.apply(e,i)}))},i.prototype.createFilter=function(t,e){var i,n=this,o=this.params,s=o.filterModifiedCallback,l=o.doesRowPassOtherFilter,a=r(r({},this.filterManager.createFilterParams(this.column,this.column.getColDef())),{filterModifiedCallback:s,filterChangedCallback:function(t){n.executeWhenAllFiltersReady((function(){return n.filterChanged(e,t)}))},doesRowPassOtherFilter:function(t){return l(t)&&n.doesFilterPass({node:t,data:t.data},i)}}),u=this.userComponentFactory.getFilterDetails(t,a,"agTextColumnFilter");if(!u)return null;var c=u.newAgStackInstance();return c&&c.then((function(t){return i=t})),c},i.prototype.executeWhenAllFiltersReady=function(t){this.filters&&this.filters.length>0?t():this.afterFiltersReadyFuncs.push(t)},i.prototype.updateActiveList=function(t){var i=this.filters[t];e._.removeFromArray(this.activeFilterIndices,t),i.isFilterActive()&&this.activeFilterIndices.push(t)},i.prototype.filterChanged=function(t,e){this.updateActiveList(t),this.filterChangedCallback(e);var i=this.filters[t];this.filters.forEach((function(t){t!==i&&"function"==typeof t.onAnyFilterChanged&&t.onAnyFilterChanged()}))},i.prototype.onFocusIn=function(t){return null==this.lastActivatedMenuItem||this.lastActivatedMenuItem.getGui().contains(t.target)||(this.lastActivatedMenuItem.deactivate(),this.lastActivatedMenuItem=null),!0},i.prototype.getModelAsString=function(t){var e,i,n,r;if(!this.filters||!(null===(e=null==t?void 0:t.filterModels)||void 0===e?void 0:e.length))return"";var o=null!==(i=this.getLastActiveFilterIndex())&&void 0!==i?i:0,s=this.filters[o];return null!==(r=null===(n=s.getModelAsString)||void 0===n?void 0:n.call(s,t.filterModels[o]))&&void 0!==r?r:""},o([e.Autowired("filterManager")],i.prototype,"filterManager",void 0),o([e.Autowired("userComponentFactory")],i.prototype,"userComponentFactory",void 0),o([e.PostConstruct],i.prototype,"postConstruct",null),i}(e.TabGuardComp),l=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},u=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},c=function(t){function i(){var e=t.call(this,'<div class="ag-multi-floating-filter ag-floating-filter-input"></div>')||this;return e.floatingFilters=[],e.compDetailsList=[],e}return l(i,t),i.prototype.init=function(t){this.params=t;var e=this.getCompDetailsList(t).compDetailsList;return this.setParams(e)},i.prototype.setParams=function(t){var i=this,n=[];return t.forEach((function(t){var e=null==t?void 0:t.newAgStackInstance();null!=e&&(i.compDetailsList.push(t),n.push(e))})),e.AgPromise.all(n).then((function(t){t.forEach((function(t,n){i.floatingFilters.push(t);var r=t.getGui();i.appendChild(r),n>0&&e._.setDisplayed(r,!1)}))}))},i.prototype.onParamsUpdated=function(t){var i=this;this.params=t;var n=this.getCompDetailsList(t),r=n.compDetailsList,o=n.floatingFilterParamsList;r.length===this.compDetailsList.length&&r.every((function(t,e){return!i.filterManager.areFilterCompsDifferent(i.compDetailsList[e],t)}))?o.forEach((function(t,e){var n,r=i.floatingFilters[e];null===(n=r.onParamsUpdated)||void 0===n||n.call(r,t)})):(e._.clearElement(this.getGui()),this.destroyBeans(this.floatingFilters),this.floatingFilters=[],this.compDetailsList=[],this.setParams(r))},i.prototype.getCompDetailsList=function(t){var i=this,n=[],r=[],o=t.filterParams;return s.getFilterDefs(o).forEach((function(o,s){var l=a(a({},t),{parentFilterInstance:function(t){i.parentMultiFilterInstance((function(e){var i=e.getChildFilterInstance(s);null!=i&&t(i)}))}});e._.mergeDeep(l.filterParams,o.filterParams);var u=i.getCompDetails(o,l);u&&(n.push(u),r.push(l))})),{compDetailsList:n,floatingFilterParamsList:r}},i.prototype.onParentModelChanged=function(t,i){var n=this;i&&i.afterFloatingFilter||this.parentMultiFilterInstance((function(r){if(null==t)n.floatingFilters.forEach((function(t,n){t.onParentModelChanged(null,i),e._.setDisplayed(t.getGui(),0===n)}));else{var o=r.getLastActiveFilterIndex();n.floatingFilters.forEach((function(n,r){var s=t.filterModels.length>r?t.filterModels[r]:null;n.onParentModelChanged(s,i);var l=null==o?0===r:r===o;e._.setDisplayed(n.getGui(),l)}))}}))},i.prototype.destroy=function(){this.destroyBeans(this.floatingFilters),this.floatingFilters.length=0,t.prototype.destroy.call(this)},i.prototype.getCompDetails=function(t,e){var i,n=this,r=null!==(i=this.userComponentFactory.getDefaultFloatingFilterType(t,(function(){return n.filterManager.getDefaultFloatingFilter(n.params.column)})))&&void 0!==i?i:"agReadOnlyFloatingFilter";return this.userComponentFactory.getFloatingFilterCompDetails(t,e,r)},i.prototype.parentMultiFilterInstance=function(t){this.params.parentFilterInstance((function(e){if(!(e instanceof s))throw new Error("AG Grid - MultiFloatingFilterComp expects MultiFilter as its parent");t(e)}))},u([e.Autowired("userComponentFactory")],i.prototype,"userComponentFactory",void 0),u([e.Autowired("filterManager")],i.prototype,"filterManager",void 0),i}(e.Component),f={version:"31.0.0",moduleName:e.ModuleNames.MultiFilterModule,beans:[],userComponents:[{componentName:"agMultiColumnFilter",componentClass:s},{componentName:"agMultiColumnFloatingFilter",componentClass:c}],dependantModules:[i.EnterpriseCoreModule]};exports.MultiFilter=s,exports.MultiFilterModule=f;