/**
          * @ag-grid-enterprise/server-side-row-model - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v31.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/server-side-row-model - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v31.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("@ag-grid-community/core"),o=require("@ag-grid-enterprise/core"),r=(e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)},function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}),n=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},i=function(e){function o(o,r,n){var i=e.call(this,0)||this;return i.nodeIdSequence=new t.NumberSequence,i.info={},i.ssrmParams=o,i.parentRowNode=n,i.level=n.level+1,i.groupLevel=o.rowGroupCols?i.level<o.rowGroupCols.length:void 0,i.leafGroup=!!o.rowGroupCols&&i.level===o.rowGroupCols.length-1,i}return r(o,e),o.prototype.postConstruct=function(){var e=this;if(this.usingTreeData=this.gridOptionsService.get("treeData"),this.nodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.parentRowNode),!this.usingTreeData&&this.groupLevel){var o=this.ssrmParams.rowGroupCols[this.level];this.groupField=o.field,this.rowGroupColumn=this.columnModel.getRowGroupColumns()[this.level]}var r=1,n=-1===this.parentRowNode.level,i=this.storeUtils.getServerSideInitialRowCount();n&&null!=i&&(r=i),this.initialiseRowNodes(r),this.rowNodeBlockLoader.addBlock(this),this.addDestroyFunc((function(){return e.rowNodeBlockLoader.removeBlock(e)})),this.postSortFunc=this.gridOptionsService.getCallback("postSortRows"),null!=i&&this.eventService.dispatchEventOnce({type:t.Events.EVENT_ROW_COUNT_READY})},o.prototype.destroyRowNodes=function(){this.blockUtils.destroyRowNodes(this.allRowNodes),this.allRowNodes=[],this.nodesAfterSort=[],this.nodesAfterFilter=[],this.allNodesMap={}},o.prototype.initialiseRowNodes=function(e,t){void 0===t&&(t=!1),this.destroyRowNodes();for(var o=0;o<e;o++){var r=this.blockUtils.createRowNode({field:this.groupField,group:this.groupLevel,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn});t&&(r.failedLoad=!0),this.allRowNodes.push(r),this.nodesAfterFilter.push(r),this.nodesAfterSort.push(r)}},o.prototype.getBlockStateJson=function(){return{id:this.nodeIdPrefix?this.nodeIdPrefix:"",state:this.getState()}},o.prototype.loadFromDatasource=function(){this.storeUtils.loadFromDatasource({startRow:void 0,endRow:void 0,parentBlock:this,parentNode:this.parentRowNode,storeParams:this.ssrmParams,success:this.success.bind(this,this.getVersion()),fail:this.pageLoadFailed.bind(this,this.getVersion())})},o.prototype.getStartRow=function(){return 0},o.prototype.getEndRow=function(){return this.nodesAfterSort.length},o.prototype.createDataNode=function(e,o){var r=this.blockUtils.createRowNode({field:this.groupField,group:this.groupLevel,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn});null!=o?t._.insertIntoArray(this.allRowNodes,r,o):this.allRowNodes.push(r);var n=this.prefixId(this.nodeIdSequence.next());return this.blockUtils.setDataIntoRowNode(r,e,n,void 0),this.nodeManager.addRowNode(r),this.blockUtils.checkOpenByDefault(r),this.allNodesMap[r.id]=r,r},o.prototype.prefixId=function(e){return this.nodeIdPrefix?this.nodeIdPrefix+"-"+e:e.toString()},o.prototype.processServerFail=function(){this.initialiseRowNodes(1,!0),this.fireStoreUpdatedEvent(),this.flushAsyncTransactions()},o.prototype.processServerResult=function(e){if(this.isAlive()){var o=e.groupLevelInfo;o&&Object.assign(this.info,o),e.pivotResultFields&&this.serverSideRowModel.generateSecondaryColumns(e.pivotResultFields);var r=this.allRowNodes.length>0?this.allNodesMap:void 0;this.allRowNodes=[],this.nodesAfterSort=[],this.nodesAfterFilter=[],this.allNodesMap={},e.rowData||t._.warnOnce('"params.data" is missing from Server-Side Row Model success() callback. Please use the "data" attribute. If no data is returned, set an empty list.'),this.createOrRecycleNodes(r,e.rowData),r&&this.blockUtils.destroyRowNodes(t._.getAllValuesInObject(r)),0===this.level&&this.eventService.dispatchEventOnce({type:t.Events.EVENT_ROW_COUNT_READY}),this.filterAndSortNodes(),this.fireStoreUpdatedEvent(),this.flushAsyncTransactions()}},o.prototype.createOrRecycleNodes=function(e,t){var o=this;if(t){t.forEach((function(t){var r=function(t){if(e){var r=o.gridOptionsService.getCallback("getRowId");if(r){var n=o.parentRowNode.getGroupKeys(),i=o.level,s=r({data:t,parentKeys:n.length>0?n:void 0,level:i}),d=e[s];if(d)return delete e[s],d}}}(t);r?function(e,t){o.allNodesMap[e.id]=e,o.blockUtils.updateDataIntoRowNode(e,t),o.allRowNodes.push(e)}(r,t):o.createDataNode(t)}))}},o.prototype.flushAsyncTransactions=function(){var e=this;window.setTimeout((function(){return e.transactionManager.flushAsyncTransactions()}),0)},o.prototype.filterAndSortNodes=function(){this.filterRowNodes(),this.sortRowNodes()},o.prototype.sortRowNodes=function(){var e=this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerSideSortOnServer(),t=this.sortController.getSortOptions(),o=!t||0==t.length;if(e||o)this.nodesAfterSort=this.nodesAfterFilter;else if(this.nodesAfterSort=this.rowNodeSorter.doFullSort(this.nodesAfterFilter,t),this.postSortFunc){var r={nodes:this.nodesAfterSort};this.postSortFunc(r)}},o.prototype.filterRowNodes=function(){var e=this,t=!this.storeUtils.isServerSideOnlyRefreshFilteredGroups()||this.storeUtils.isServerSideFilterOnServer(),o=this.groupLevel;this.nodesAfterFilter=t||o?this.allRowNodes:this.allRowNodes.filter((function(t){return e.filterManager.doesRowPassFilter({rowNode:t})}))},o.prototype.clearDisplayIndexes=function(){var e=this;this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.allRowNodes.forEach((function(t){return e.blockUtils.clearDisplayIndex(t)}))},o.prototype.getDisplayIndexEnd=function(){return this.displayIndexEnd},o.prototype.isDisplayIndexInStore=function(e){return 0!==this.getRowCount()&&(e>=this.displayIndexStart&&e<this.displayIndexEnd)},o.prototype.setDisplayIndexes=function(e,t){var o=this;this.displayIndexStart=e.peek(),this.topPx=t.value;var r={};this.nodesAfterSort.forEach((function(n){o.blockUtils.setDisplayIndex(n,e,t),r[n.id]=!0})),this.allRowNodes.forEach((function(e){r[e.id]||o.blockUtils.clearDisplayIndex(e)})),this.displayIndexEnd=e.peek(),this.heightPx=t.value-this.topPx},o.prototype.forEachStoreDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),e(this,o.next()),this.allRowNodes.forEach((function(t){var r=t.childStore;r&&r.forEachStoreDeep(e,o)}))},o.prototype.forEachNodeDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),this.allRowNodes.forEach((function(t){e(t,o.next());var r=t.childStore;r&&r.forEachNodeDeep(e,o)}))},o.prototype.forEachNodeDeepAfterFilterAndSort=function(e,o,r){void 0===o&&(o=new t.NumberSequence),void 0===r&&(r=!1),this.nodesAfterSort.forEach((function(t){e(t,o.next());var n=t.childStore;n&&n.forEachNodeDeepAfterFilterAndSort(e,o,r)})),r&&this.parentRowNode.sibling&&e(this.parentRowNode.sibling,o.next())},o.prototype.getRowUsingDisplayIndex=function(e){if(this.isDisplayIndexInStore(e))return this.blockUtils.binarySearchForDisplayIndex(e,this.nodesAfterSort)},o.prototype.getRowBounds=function(e){for(var t=0;t<this.nodesAfterSort.length;t++){var o=this.nodesAfterSort[t],r=this.blockUtils.extractRowBounds(o,e);if(r)return r}return null},o.prototype.isPixelInRange=function(e){return e>=this.topPx&&e<this.topPx+this.heightPx},o.prototype.getRowIndexAtPixel=function(e){var t=this;if(e<=this.topPx)return this.nodesAfterSort[0].rowIndex;if(e>=this.topPx+this.heightPx){var o=this.nodesAfterSort[this.nodesAfterSort.length-1],r=o.rowTop+o.rowHeight;if(e>=r&&o.expanded){if(o.childStore&&o.childStore.getRowCount()>0)return o.childStore.getRowIndexAtPixel(e);if(o.detailNode)return o.detailNode.rowIndex}return o.rowIndex}var n=null;return this.nodesAfterSort.forEach((function(o){var r=t.blockUtils.getIndexAtPixel(o,e);null!=r&&(n=r)})),null==n?this.displayIndexEnd-1:n},o.prototype.getChildStore=function(e){var t=this;return this.storeUtils.getChildStore(e,this,(function(e){return t.allRowNodes.find((function(t){return t.key==e}))}))},o.prototype.forEachChildStoreShallow=function(e){this.allRowNodes.forEach((function(t){var o=t.childStore;o&&e(o)}))},o.prototype.refreshAfterFilter=function(e){var t=this.storeUtils.isServerSideFilterOnServer(),o=this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e);if(!this.storeUtils.isServerSideOnlyRefreshFilteredGroups()||t&&o)return this.refreshStore(!0),void this.sortRowNodes();this.filterRowNodes(),this.sortRowNodes(),this.forEachChildStoreShallow((function(t){return t.refreshAfterFilter(e)}))},o.prototype.refreshAfterSort=function(e){var t=this.storeUtils.isServerSideSortOnServer(),o=this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e);if(this.storeUtils.isServerSideSortAllLevels()||t&&o)return this.refreshStore(!0),void this.filterRowNodes();this.filterRowNodes(),this.sortRowNodes(),this.forEachChildStoreShallow((function(t){return t.refreshAfterSort(e)}))},o.prototype.applyTransaction=function(e){switch(this.getState()){case t.RowNodeBlock.STATE_FAILED:return{status:t.ServerSideTransactionResultStatus.StoreLoadingFailed};case t.RowNodeBlock.STATE_LOADING:return{status:t.ServerSideTransactionResultStatus.StoreLoading};case t.RowNodeBlock.STATE_WAITING_TO_LOAD:return{status:t.ServerSideTransactionResultStatus.StoreWaitingToLoad}}var o=this.gridOptionsService.getCallback("isApplyServerSideTransaction");if(o&&!o({transaction:e,parentNode:this.parentRowNode,groupLevelInfo:this.info}))return{status:t.ServerSideTransactionResultStatus.Cancelled};var r={status:t.ServerSideTransactionResultStatus.Applied,remove:[],update:[],add:[]},n=[];return this.executeAdd(e,r),this.executeRemove(e,r,n),this.executeUpdate(e,r,n),this.filterAndSortNodes(),this.updateSelection(n),r},o.prototype.updateSelection=function(e){if(e.length>0){this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,clearSelection:!1,source:"rowDataChanged"});var o={type:t.Events.EVENT_SELECTION_CHANGED,source:"rowDataChanged"};this.eventService.dispatchEvent(o)}},o.prototype.executeAdd=function(e,o){var r=this,n=e.add,i=e.addIndex;t._.missingOrEmpty(n)||("number"==typeof i&&i>=0?n.reverse().forEach((function(e){var t=r.createDataNode(e,i);o.add.push(t)})):n.forEach((function(e){var t=r.createDataNode(e);o.add.push(t)})))},o.prototype.executeRemove=function(e,t,o){var r=this,n=e.remove;if(null!=n){var i={};n.forEach((function(e){var n=r.lookupRowNode(e);n&&(n.isSelected()&&o.push(n),n.clearRowTopAndRowIndex(),i[n.id]=!0,delete r.allNodesMap[n.id],t.remove.push(n),r.nodeManager.removeNode(n))})),this.allRowNodes=this.allRowNodes.filter((function(e){return!i[e.id]}))}},o.prototype.executeUpdate=function(e,t,o){var r=this,n=e.update;null!=n&&n.forEach((function(e){var n=r.lookupRowNode(e);n&&(r.blockUtils.updateDataIntoRowNode(n,e),!n.selectable&&n.isSelected()&&o.push(n),t.update.push(n))}))},o.prototype.lookupRowNode=function(e){var t,o=this.gridOptionsService.getCallback("getRowId");if(null!=o){var r=this.level,n=this.parentRowNode.getGroupKeys(),i=o({data:e,parentKeys:n.length>0?n:void 0,level:r});if(!(t=this.allNodesMap[i]))return console.error("AG Grid: could not find row id=".concat(i,", data item was not found for this id")),null}else if(!(t=this.allRowNodes.find((function(t){return t.data===e}))))return console.error("AG Grid: could not find data item as object was not found",e),null;return t},o.prototype.addStoreStates=function(e){e.push({suppressInfiniteScroll:!0,route:this.parentRowNode.getGroupKeys(),rowCount:this.allRowNodes.length,info:this.info}),this.forEachChildStoreShallow((function(t){return t.addStoreStates(e)}))},o.prototype.refreshStore=function(e){if(e){var t=this.nodesAfterSort?this.nodesAfterSort.length:1;this.initialiseRowNodes(t)}this.scheduleLoad(),this.fireStoreUpdatedEvent()},o.prototype.retryLoads=function(){this.getState()===t.RowNodeBlock.STATE_FAILED&&(this.initialiseRowNodes(1),this.scheduleLoad()),this.forEachChildStoreShallow((function(e){return e.retryLoads()}))},o.prototype.scheduleLoad=function(){this.setStateWaitingToLoad(),this.rowNodeBlockLoader.checkBlockToLoad()},o.prototype.fireStoreUpdatedEvent=function(){var e={type:t.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)},o.prototype.getRowCount=function(){return this.nodesAfterSort.length},o.prototype.getTopLevelRowDisplayedIndex=function(e){return this.nodesAfterSort[e].rowIndex},o.prototype.isLastRowIndexKnown=function(){return this.getState()==t.RowNodeBlock.STATE_LOADED},o.prototype.getRowNodesInRange=function(e,o){var r=[],n=!1;return t._.missing(e)&&(n=!0),this.nodesAfterSort.forEach((function(t){var i=t===e||t===o;(n||i)&&r.push(t),i&&(n=!n)})),n?[]:r},o.prototype.getStoreBounds=function(){return{topPx:this.topPx,heightPx:this.heightPx}},n([t.Autowired("ssrmStoreUtils")],o.prototype,"storeUtils",void 0),n([t.Autowired("ssrmBlockUtils")],o.prototype,"blockUtils",void 0),n([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),n([t.Autowired("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),n([t.Autowired("rowNodeSorter")],o.prototype,"rowNodeSorter",void 0),n([t.Autowired("sortController")],o.prototype,"sortController",void 0),n([t.Autowired("selectionService")],o.prototype,"selectionService",void 0),n([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),n([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),n([t.Autowired("ssrmTransactionManager")],o.prototype,"transactionManager",void 0),n([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),n([t.PostConstruct],o.prototype,"postConstruct",null),n([t.PreDestroy],o.prototype,"destroyRowNodes",null),o}(t.RowNodeBlock),s=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),d=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},a=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},l=function(e){function o(t,o,r){var n=e.call(this)||this;return n.loadingNodes=new Set,n.checkForLoadQueued=!1,n.loaderTimeout=void 0,n.nextBlockToLoad=void 0,n.parentNode=o,n.cache=t,n.storeParams=r,n}return s(o,e),o.prototype.init=function(){var e=this;this.addManagedListener(this.rowNodeBlockLoader,t.RowNodeBlockLoader.BLOCK_LOADED_EVENT,(function(){return e.queueLoadAction()}))},o.prototype.isRowLoading=function(e){return this.loadingNodes.has(e)},o.prototype.getBlockToLoad=function(){for(var e,t=this,o=this.api.getFirstDisplayedRow(),r=this.api.getLastDisplayedRow(),n=o;n<=r;n++){var i=this.cache.getNodeCachedByDisplayIndex(n);if(i){var s=this.cache.getNodes().getBy("node",i);if(s&&!this.isRowLoading(s.index)&&(i.__needsRefreshWhenVisible||i.stub&&!i.failedLoad))return this.getBlockStartIndexForIndex(s.index)}}var d=this.cache.getNodesToRefresh(),a=null,l=Number.MAX_SAFE_INTEGER;d.forEach((function(e){if(null!=e.rowIndex){if(!t.isRowLoading(e.rowIndex)){var n=Math.abs(o-e.rowIndex),i=Math.abs(e.rowIndex-r);n<l&&(a=e,l=n),i<l&&(a=e,l=i)}}else a=e}));var c=null===(e=this.cache.getNodes().getBy("node",a))||void 0===e?void 0:e.index;return null==c?void 0:this.getBlockStartIndexForIndex(c)},o.prototype.reset=function(){this.loadingNodes.clear(),clearTimeout(this.loaderTimeout),this.loaderTimeout=void 0},o.prototype.executeLoad=function(e,t){var o,r=this,n=this.cache.getSsrmParams(),i={startRow:e,endRow:t,rowGroupCols:n.rowGroupCols,valueCols:n.valueCols,pivotCols:n.pivotCols,pivotMode:n.pivotMode,groupKeys:this.parentNode.getGroupKeys(),filterModel:n.filterModel,sortModel:n.sortModel},s=function(){for(var o=0;o<t-e;o++)r.loadingNodes.delete(e+o)},d={request:i,success:function(o){r.rowNodeBlockLoader.loadComplete(),r.cache.onLoadSuccess(e,t-e,o),s(),r.queueLoadAction()},fail:function(){r.rowNodeBlockLoader.loadComplete(),r.cache.onLoadFailed(e,t-e),s(),r.queueLoadAction()},parentNode:this.parentNode,api:this.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};!function(){for(var o=0;o<t-e;o++)r.loadingNodes.add(e+o)}(),null===(o=this.cache.getSsrmParams().datasource)||void 0===o||o.getRows(d)},o.prototype.getNextBlockToLoad=function(){var e=this.getBlockToLoad();return null!=e?[String(e),e+this.getBlockSize()]:null},o.prototype.queueLoadCheck=function(){var e=this;this.checkForLoadQueued||(this.checkForLoadQueued=!0,window.queueMicrotask((function(){e.checkForLoadQueued=!1,e.queueLoadAction()})))},o.prototype.queueLoadAction=function(){var e=this,t=this.getNextBlockToLoad();if(!t)return window.clearTimeout(this.loaderTimeout),this.loaderTimeout=void 0,void(this.nextBlockToLoad=void 0);if(!this.nextBlockToLoad||this.nextBlockToLoad[0]!==t[0]&&this.nextBlockToLoad[1]!==t[1]){this.nextBlockToLoad=t,window.clearTimeout(this.loaderTimeout);var o=a(this.nextBlockToLoad,2),r=o[0],n=o[1],i=Number(r);this.loaderTimeout=window.setTimeout((function(){e.cache.isAlive()&&(e.loaderTimeout=void 0,e.attemptLoad(i,n),e.nextBlockToLoad=void 0)}),this.gridOptionsService.get("blockLoadDebounceMillis"))}},o.prototype.attemptLoad=function(e,t){var o=this.rowNodeBlockLoader.getAvailableLoadingCount();null!=o&&0===o||(this.rowNodeBlockLoader.registerLoads(1),this.executeLoad(e,t),this.queueLoadAction())},o.prototype.getBlockSize=function(){return this.storeParams.cacheBlockSize||o.DEFAULT_BLOCK_SIZE},o.prototype.getBlockStartIndexForIndex=function(e){return e-e%this.getBlockSize()},o.prototype.getBlockBoundsForIndex=function(e){var t=this.getBlockStartIndexForIndex(e);return[t,t+this.getBlockSize()]},o.DEFAULT_BLOCK_SIZE=100,d([t.Autowired("gridApi")],o.prototype,"api",void 0),d([t.Autowired("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),d([t.PostConstruct],o.prototype,"init",null),o}(t.BeanStub),c=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length<1)throw new Error("AG Grid: At least one index must be provided.");this.indexes=e,this.maps=new Map(this.indexes.map((function(e){return[e,new Map]})))}return e.prototype.getBy=function(e,t){var o=this.maps.get(e);if(!o)throw new Error("AG Grid: ".concat(String(e)," not found"));return o.get(t)},e.prototype.set=function(e){var t=this;this.indexes.forEach((function(o){var r=t.maps.get(o);if(!r)throw new Error("AG Grid: ".concat(String(o)," not found"));r.set(e[o],e)}))},e.prototype.delete=function(e){var t=this;this.indexes.forEach((function(o){var r=t.maps.get(o);if(!r)throw new Error("AG Grid: ".concat(String(o)," not found"));r.delete(e[o])}))},e.prototype.clear=function(){this.maps.forEach((function(e){return e.clear()}))},e.prototype.getIterator=function(e){var t=this.maps.get(e);if(!t)throw new Error("AG Grid: ".concat(String(e)," not found"));return t.values()},e.prototype.forEach=function(e){for(var t,o=this.getIterator(this.indexes[0]);(t=o.next())&&!t.done;)e(t.value)},e.prototype.find=function(e){for(var t,o=this.getIterator(this.indexes[0]);(t=o.next())&&!t.done;)if(e(t.value))return t.value},e.prototype.filter=function(e){for(var t,o=this.getIterator(this.indexes[0]),r=[];(t=o.next())&&!t.done;)e(t.value)&&r.push(t.value);return r},e}(),u=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),p=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},h=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},f=function(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},v=function(e){function o(t,o,r){var n=e.call(this)||this;return n.live=!0,n.removedNodeCache=new Map,n.store=t,n.numberOfRows=o,n.isLastRowKnown=!1,n.storeParams=r,n}return u(o,e),o.prototype.init=function(){this.nodeMap=new c("index","id","node"),this.nodeDisplayIndexMap=new Map,this.nodesToRefresh=new Set,this.defaultNodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),this.rowLoader=this.createManagedBean(new l(this,this.store.getParentNode(),this.storeParams)),this.getRowIdFunc=this.gridOptionsService.getCallback("getRowId"),this.isMasterDetail=this.gridOptionsService.get("masterDetail")},o.prototype.destroyRowNodes=function(){var e=this;this.numberOfRows=0,this.nodeMap.forEach((function(t){return e.blockUtils.destroyRowNode(t.node)})),this.nodeMap.clear(),this.nodeDisplayIndexMap.clear(),this.nodesToRefresh.clear(),this.live=!1},o.prototype.getRowByDisplayIndex=function(e){var t,o,r,n;if(this.store.isDisplayIndexInStore(e)){var i=this.nodeDisplayIndexMap.get(e);if(i)return(i.stub||i.__needsRefreshWhenVisible)&&this.rowLoader.queueLoadCheck(),i;if(e===this.store.getDisplayIndexStart())return this.createStubNode(0,e);var s=this.nodeDisplayIndexMap.get(e-1);if(s){if(this.isMasterDetail&&s.master&&s.expanded)return s.detailNode;if(s.expanded&&(null===(t=s.childStore)||void 0===t?void 0:t.isDisplayIndexInStore(e)))return null===(o=s.childStore)||void 0===o?void 0:o.getRowUsingDisplayIndex(e);var d=this.nodeMap.getBy("node",s);return this.createStubNode(d.index+1,e)}var a=this.getSurroundingNodesByDisplayIndex(e);if(null==a){var l=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(l,e)}var c=a.previousNode,u=a.nextNode;if(c&&c.node.expanded&&(null===(r=c.node.childStore)||void 0===r?void 0:r.isDisplayIndexInStore(e)))return null===(n=c.node.childStore)||void 0===n?void 0:n.getRowUsingDisplayIndex(e);if(u){var p=u.node.rowIndex-e,h=u.index-p;return this.createStubNode(h,e)}var f=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(f,e)}},o.prototype.createStubNode=function(e,t){var o=this,r=this.store.getRowBounds(t),n=this.createRowAtIndex(e,null,(function(e){e.setRowIndex(t),e.setRowTop(r.rowTop),o.nodeDisplayIndexMap.set(t,e)}));return this.rowLoader.queueLoadCheck(),n},o.prototype.getRowByStoreIndex=function(e){var t;return null===(t=this.nodeMap.getBy("index",e))||void 0===t?void 0:t.node},o.prototype.skipDisplayIndexes=function(e,t,o){if(0!==e){var r=this.gridOptionsService.getRowHeightAsNumber();t.skip(e),o.value+=e*r}},o.prototype.setDisplayIndexes=function(e,t){this.nodeDisplayIndexMap.clear();var o={};this.nodeMap.forEach((function(e){o[e.index]=e.node}));var r=-1;for(var n in o){var i=o[n],s=Number(n),d=s-1-r;this.skipDisplayIndexes(d,e,t),this.blockUtils.setDisplayIndex(i,e,t),this.nodeDisplayIndexMap.set(i.rowIndex,i),r=s}var a=this.numberOfRows-1-r;this.skipDisplayIndexes(a,e,t),this.purgeExcessRows()},o.prototype.getRowCount=function(){return this.numberOfRows},o.prototype.setRowCount=function(e,t){if(e<0)throw new Error("AG Grid: setRowCount can only accept a positive row count.");this.numberOfRows=e,null!=t&&(this.isLastRowKnown=t,!1===t&&(this.numberOfRows+=1)),this.fireStoreUpdatedEvent()},o.prototype.getNodes=function(){return this.nodeMap},o.prototype.getNodeCachedByDisplayIndex=function(e){var t;return null!==(t=this.nodeDisplayIndexMap.get(e))&&void 0!==t?t:null},o.prototype.getNodesToRefresh=function(){return this.nodesToRefresh},o.prototype.getSurroundingNodesByDisplayIndex=function(e){var t,o;return this.nodeMap.forEach((function(r){e>r.node.rowIndex?(null==o||o.node.rowIndex<r.node.rowIndex)&&(o=r):(null==t||t.node.rowIndex>r.node.rowIndex)&&(t=r)})),o||t?{previousNode:o,nextNode:t}:null},o.prototype.getDisplayIndexFromStoreIndex=function(e){var t,o,r,n,i=this.nodeMap.getBy("index",e);if(i)return i.node.rowIndex;if(this.nodeMap.forEach((function(t){e>t.index?(null==n||n.index<t.index)&&(n=t):(null==r||r.index>t.index)&&(r=t)})),!r)return this.store.getDisplayIndexEnd()-(this.numberOfRows-e);if(!n)return this.store.getDisplayIndexStart()+e;var s=e-n.index;return(null!==(o=null===(t=n.node.childStore)||void 0===t?void 0:t.getDisplayIndexEnd())&&void 0!==o?o:n.node.rowIndex)+s},o.prototype.createRowAtIndex=function(e,t,o){var r,n,i=this.nodeMap.getBy("index",e);if(i){if((l=i.node).__needsRefreshWhenVisible=!1,this.doesNodeMatch(t,l))return this.blockUtils.updateDataIntoRowNode(l,t),this.nodesToRefresh.delete(l),l;if(null==this.getRowIdFunc&&l.hasChildren()&&l.expanded)return this.nodesToRefresh.delete(l),l;this.destroyRowAtIndex(e)}if(t&&null!=this.getRowIdFunc){var s=this.getRowId(t),d=s&&(null===(r=this.removedNodeCache)||void 0===r?void 0:r.get(s));if(d)return null===(n=this.removedNodeCache)||void 0===n||n.delete(s),this.blockUtils.updateDataIntoRowNode(d,t),this.nodeMap.set({id:d.id,node:d,index:e}),d;var a=this.nodeMap.getBy("id",s);if(a){this.nodeMap.delete(a);var l=a.node,c=a.index;return this.blockUtils.updateDataIntoRowNode(l,t),this.nodeMap.set({id:l.id,node:l,index:e}),this.nodesToRefresh.delete(l),this.rowLoader.getBlockStartIndexForIndex(c)===this.rowLoader.getBlockStartIndexForIndex(e)?l:(this.markBlockForVerify(c),l)}}var u=this.blockUtils.createRowNode(this.store.getRowDetails());if(null!=t){var p=this.getPrefixedId(this.store.getIdSequence().next());this.blockUtils.setDataIntoRowNode(u,t,p,void 0),this.blockUtils.checkOpenByDefault(u),this.nodeManager.addRowNode(u)}return this.nodeMap.set({id:u.id,node:u,index:e}),o&&o(u),u},o.prototype.getBlockStates=function(){var e=this,t={},o={};this.nodeMap.forEach((function(r){var n,i=r.node,s=r.index,d=e.rowLoader.getBlockStartIndexForIndex(s);i.stub||i.failedLoad||(t[d]=(null!==(n=t[d])&&void 0!==n?n:0)+1);var a="loaded";i.failedLoad?a="failed":e.rowLoader.isRowLoading(d)?a="loading":(e.nodesToRefresh.has(i)||i.stub)&&(a="needsLoading"),o[d]||(o[d]=new Set),o[d].add(a)}));var r={loading:4,failed:3,needsLoading:2,loaded:1},n=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),i={};return Object.entries(o).forEach((function(o){var s,d=h(o,2),a=d[0],l=d[1],c=f([],h(l),!1).sort((function(e,t){var o,n;return(null!==(o=r[e])&&void 0!==o?o:0)-(null!==(n=r[t])&&void 0!==n?n:0)}))[0],u=Number(a)/e.rowLoader.getBlockSize(),p=n?"".concat(n,"-").concat(u):String(u);i[p]={blockNumber:u,startRow:Number(a),endRow:Number(a)+e.rowLoader.getBlockSize(),pageStatus:c,loadedRowCount:null!==(s=t[a])&&void 0!==s?s:0}})),i},o.prototype.destroyRowAtIndex=function(e){var t=this.nodeMap.getBy("index",e);t&&(this.nodeMap.delete(t),this.nodeDisplayIndexMap.delete(t.node.rowIndex),t.node.hasChildren()&&this.nodesToRefresh.size>0?this.removedNodeCache.set(t.node.id,t.node):this.blockUtils.destroyRowNode(t.node),this.nodesToRefresh.delete(t.node))},o.prototype.getSsrmParams=function(){return this.store.getSsrmParams()},o.prototype.getPrefixedId=function(e){return this.defaultNodeIdPrefix?this.defaultNodeIdPrefix+"-"+e:e.toString()},o.prototype.markBlockForVerify=function(e){var t=h(this.rowLoader.getBlockBoundsForIndex(e),2),o=t[0],r=t[1];this.nodeMap.filter((function(e){return e.index>=o&&e.index<r})).forEach((function(e){e.node.__needsRefreshWhenVisible=!0}))},o.prototype.doesNodeMatch=function(e,t){if(t.stub)return!1;if(null!=this.getRowIdFunc){var o=this.getRowId(e);return t.id===o}return t.data===e},o.prototype.purgeStubsOutsideOfViewport=function(){var e=this,t=this.api.getFirstDisplayedRow(),o=this.api.getLastDisplayedRow(),r=this.rowLoader.getBlockStartIndexForIndex(t),n=h(this.rowLoader.getBlockBoundsForIndex(o),2);n[0];var i=n[1];this.nodeMap.forEach((function(t){e.rowLoader.isRowLoading(t.index)||t.node.failedLoad||t.node.stub&&(t.index<r||t.index>i)&&e.destroyRowAtIndex(t.index)}))},o.prototype.getBlocksDistanceFromRow=function(e,t){var o=this,r={};return e.forEach((function(e){var n=e.node,i=e.index,s=h(o.rowLoader.getBlockBoundsForIndex(i),2),d=s[0],a=s[1];if(!(d in r)){var l,c=Math.abs(n.rowIndex-t),u=o.nodeMap.getBy("index",[a-1]);u&&(l=Math.abs(u.node.rowIndex-t));var p=null==l||c<l?c:l;r[d]=p}})),Object.entries(r)},o.prototype.purgeExcessRows=function(){var e,t=this;if(this.purgeStubsOutsideOfViewport(),null!=this.store.getDisplayIndexEnd()&&null!=this.storeParams.maxBlocksInCache){var o=this.api.getFirstDisplayedRow(),r=this.api.getLastDisplayedRow(),n=new Set,i=new Set;this.nodeMap.forEach((function(e){var s=e.index,d=e.node,a=t.rowLoader.getBlockStartIndexForIndex(s);n.add(a),d.rowIndex>=o&&d.rowIndex<=r&&i.add(a)}));var s=Math.max(i.size,null!==(e=this.storeParams.maxBlocksInCache)&&void 0!==e?e:0),d=n.size-s;if(!(d<=0)){var a=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;i.forEach((function(e){a>e&&(a=e),l<e&&(l=e)}));var c=this.nodeMap.filter((function(e){var o=e.node,r=e.index,n=t.rowLoader.getBlockStartIndexForIndex(r);return!(n>=a&&n<=l)&&!t.isNodeCached(o)}));if(0!==c.length){var u=o+(r-o)/2,p=this.getBlocksDistanceFromRow(c,u),h=this.rowLoader.getBlockSize();p.sort((function(e,t){return Math.sign(t[1]-e[1])}));for(var f=0;f<Math.min(d,p.length);f++)for(var v=Number(p[f][0]),g=v;g<v+h;g++){var y=this.nodeMap.getBy("index",g);y&&!this.isNodeCached(y.node)&&this.destroyRowAtIndex(g)}}}}},o.prototype.isNodeFocused=function(e){var t=this.focusService.getFocusCellToUseAfterRefresh();return!!t&&(null==t.rowPinned&&t.rowIndex===e.rowIndex)},o.prototype.isNodeCached=function(e){return e.isExpandable()&&e.expanded||this.isNodeFocused(e)},o.prototype.extractDuplicateIds=function(e){var t=this;if(null!=this.getRowIdFunc)return[];var o=new Set,r=new Set;return e.forEach((function(e){var n=t.getRowId(e);o.has(n)?r.add(n):o.add(n)})),f([],h(r),!1)},o.prototype.onLoadSuccess=function(e,t,o){var r=this;if(this.live){var n=o.groupLevelInfo;if(this.store.setStoreInfo(n),null!=this.getRowIdFunc){var i=this.extractDuplicateIds(o.rowData);if(i.length>0){var s=i.join(", ");return console.warn("AG Grid: Unable to display rows as duplicate row ids (".concat(s,") were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.")),void this.onLoadFailed(e,t)}}o.pivotResultFields&&this.serverSideRowModel.generateSecondaryColumns(o.pivotResultFields);var d=this.nodesToRefresh.size>0;o.rowData.forEach((function(t,o){var n,i=e+o,s=r.nodeMap.getBy("index",i);if(!(null===(n=null==s?void 0:s.node)||void 0===n?void 0:n.stub))return s&&r.doesNodeMatch(t,s.node)?(r.blockUtils.updateDataIntoRowNode(s.node,t),r.nodesToRefresh.delete(s.node),void(s.node.__needsRefreshWhenVisible=!1)):void r.createRowAtIndex(i,t);r.createRowAtIndex(i,t)}));var a=0===this.nodesToRefresh.size;if(d&&a&&this.fireRefreshFinishedEvent(),null!=o.rowCount&&-1!==o.rowCount)this.numberOfRows=o.rowCount,this.isLastRowKnown=!0;else if(t>o.rowData.length)this.numberOfRows=e+o.rowData.length,this.isLastRowKnown=!0;else if(!this.isLastRowKnown){var l=e+o.rowData.length+1;l>this.numberOfRows&&(this.numberOfRows=l)}if(this.isLastRowKnown)this.nodeMap.filter((function(e){return e.index>=r.numberOfRows})).forEach((function(e){return r.destroyRowAtIndex(e.index)}));this.fireStoreUpdatedEvent()}},o.prototype.fireRefreshFinishedEvent=function(){var e=this;0===this.nodesToRefresh.size&&(this.removedNodeCache.forEach((function(t){e.blockUtils.destroyRowNode(t)})),this.removedNodeCache=new Map,this.store.fireRefreshFinishedEvent())},o.prototype.isLastRowIndexKnown=function(){return this.isLastRowKnown},o.prototype.onLoadFailed=function(e,t){var o;if(this.live){for(var r=this.nodesToRefresh.size>0,n=e;n<e+t&&n<this.getRowCount();n++){var i=(null!==(o=this.nodeMap.getBy("index",n))&&void 0!==o?o:{}).node;i&&this.nodesToRefresh.delete(i),i&&i.stub||(i&&!i.stub&&this.destroyRowAtIndex(n),i=this.createRowAtIndex(n)),i.__needsRefreshWhenVisible=!1,i.failedLoad=!0}var s=0===this.nodesToRefresh.size;r&&s&&this.fireRefreshFinishedEvent(),this.fireStoreUpdatedEvent()}},o.prototype.markNodesForRefresh=function(){var e=this;this.nodeMap.forEach((function(t){t.node.stub&&!t.node.failedLoad||e.nodesToRefresh.add(t.node)})),this.rowLoader.queueLoadCheck(),this.isLastRowKnown&&0===this.numberOfRows&&(this.numberOfRows=1,this.isLastRowKnown=!1,this.fireStoreUpdatedEvent())},o.prototype.isNodeInCache=function(e){return!!this.nodeMap.getBy("id",e)},o.prototype.fireStoreUpdatedEvent=function(){this.live&&this.store.fireStoreUpdatedEvent()},o.prototype.getRowId=function(e){if(null==this.getRowIdFunc)return null;var t=this.store.getRowDetails().level,o=this.store.getParentNode().getGroupKeys(),r=this.getRowIdFunc({data:e,parentKeys:o.length>0?o:void 0,level:t});return String(r)},o.prototype.updateRowNodes=function(e){var t=this;if(null==this.getRowIdFunc)throw new Error("AG Grid: Transactions can only be applied when row ids are supplied.");var o=[];return e.forEach((function(e){var r=t.getRowId(e),n=t.nodeMap.getBy("id",r);n&&(t.blockUtils.updateDataIntoRowNode(n.node,e),o.push(n.node))})),o},o.prototype.insertRowNodes=function(e,t){var o=this,r=this.store.getRowCount()-(this.store.getParentNode().sibling?1:0),n=null==t&&this.isLastRowKnown?r:t;if(null==n||r<n)return[];if(null==this.getRowIdFunc)throw new Error("AG Grid: Transactions can only be applied when row ids are supplied.");var i={};e.forEach((function(e){var t=o.getRowId(e);t&&o.isNodeInCache(t)||(i[t]=e)}));var s=Object.values(i),d=s.length;if(0===d)return[];var a=this.nodeMap.filter((function(e){return e.index>=n}));return a.forEach((function(e){return o.nodeMap.delete(e)})),a.forEach((function(e){o.nodeMap.set({node:e.node,index:e.index+d,id:e.id})})),this.numberOfRows+=d,s.map((function(e,t){return o.createRowAtIndex(n+t,e)}))},o.prototype.getOrderedNodeMap=function(){var e={};return this.nodeMap.forEach((function(t){return e[t.index]=t})),e},o.prototype.clearDisplayIndexes=function(){this.nodeDisplayIndexMap.clear()},o.prototype.removeRowNodes=function(e){if(null==this.getRowIdFunc)throw new Error("AG Grid: Transactions can only be applied when row ids are supplied.");var t=[],o=[],r=0,n=f([],h(e),!1),i=this.getOrderedNodeMap(),s=-1,d=function(e){s+=1;var d=i[e],l=n.findIndex((function(e){return e===d.id}));if(-1!==l)return n.splice(l,1),a.destroyRowAtIndex(Number(e)),t.push(d.node),r+=1,"continue";if(0===r)return"continue";var c=Number(e);s!==c&&o.push(d.node),a.nodeMap.delete(i[e]),a.nodeMap.set({id:d.id,node:d.node,index:c-r})},a=this;for(var l in i)d(l);return this.numberOfRows-=this.isLastRowIndexKnown()?e.length:r,n.length>0&&o.length>0&&(o.forEach((function(e){return e.__needsRefreshWhenVisible=!0})),this.rowLoader.queueLoadCheck()),t},p([t.Autowired("gridApi")],o.prototype,"api",void 0),p([t.Autowired("ssrmBlockUtils")],o.prototype,"blockUtils",void 0),p([t.Autowired("focusService")],o.prototype,"focusService",void 0),p([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),p([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),p([t.PostConstruct],o.prototype,"init",null),p([t.PreDestroy],o.prototype,"destroyRowNodes",null),o}(t.BeanStub),g=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),y=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},w=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},S=function(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},R=function(e){function o(o,r,n){var i=e.call(this)||this;return i.idSequence=new t.NumberSequence,i.ssrmParams=o,i.parentRowNode=n,i.storeParams=r,i.level=n.level+1,i.group=!!o.rowGroupCols&&i.level<o.rowGroupCols.length,i.leafGroup=!!o.rowGroupCols&&i.level===o.rowGroupCols.length-1,i.info={},i}return g(o,e),o.prototype.init=function(){var e,o=1;if(0===this.level&&(o=null!==(e=this.storeUtils.getServerSideInitialRowCount())&&void 0!==e?e:1,this.eventService.dispatchEventOnce({type:t.Events.EVENT_ROW_COUNT_READY})),this.cache=this.createManagedBean(new v(this,o,this.storeParams)),!this.gridOptionsService.get("treeData")&&this.group){var r=this.ssrmParams.rowGroupCols[this.level];this.groupField=r.field,this.rowGroupColumn=this.columnModel.getRowGroupColumns()[this.level]}},o.prototype.destroyRowNodes=function(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.destroyBean(this.cache)},o.prototype.applyRowData=function(e,t,o){this.cache.onLoadSuccess(t,o,e)},o.prototype.applyTransaction=function(e){var o,r,n,i=this,s=this.gridOptionsService.getCallback("getRowId");if(!s)return console.warn("AG Grid: getRowId callback must be implemented for transactions to work. Transaction was ignored."),{status:t.ServerSideTransactionResultStatus.Cancelled};var d=this.gridOptionsService.getCallback("isApplyServerSideTransaction");if(d&&!d({transaction:e,parentNode:this.parentRowNode,groupLevelInfo:this.info}))return{status:t.ServerSideTransactionResultStatus.Cancelled};var a=void 0;(null===(o=e.update)||void 0===o?void 0:o.length)&&(a=this.cache.updateRowNodes(e.update));var l=void 0;if(null===(r=e.add)||void 0===r?void 0:r.length){var c=e.addIndex;null!=c&&c<0&&(c=void 0),l=this.cache.insertRowNodes(e.add,c)}var u=void 0;if(null===(n=e.remove)||void 0===n?void 0:n.length){var p=e.remove.map((function(e){return s({level:i.level,parentKeys:i.parentRowNode.getGroupKeys(),data:e})})),h=S([],w(new Set(p)),!1);u=this.cache.removeRowNodes(h)}return this.updateSelectionAfterTransaction(a,u),{status:t.ServerSideTransactionResultStatus.Applied,update:a,add:l,remove:u}},o.prototype.updateSelectionAfterTransaction=function(e,t){var o=[];null==e||e.forEach((function(e){e.isSelected()&&!e.selectable&&o.push(e)})),null==t||t.forEach((function(e){e.isSelected()&&o.push(e)})),o.length&&this.selectionService.setNodesSelected({newValue:!1,clearSelection:!1,nodes:o,source:"rowDataChanged"})},o.prototype.clearDisplayIndexes=function(){var e=this;this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.cache.getNodes().forEach((function(t){return e.blockUtils.clearDisplayIndex(t.node)})),this.parentRowNode.sibling&&this.blockUtils.clearDisplayIndex(this.parentRowNode.sibling),this.cache.clearDisplayIndexes()},o.prototype.getDisplayIndexStart=function(){return this.displayIndexStart},o.prototype.getDisplayIndexEnd=function(){return this.displayIndexEnd},o.prototype.getRowCount=function(){return this.parentRowNode.sibling?this.cache.getRowCount()+1:this.cache.getRowCount()},o.prototype.setRowCount=function(e,t){this.cache.setRowCount(e,t)},o.prototype.isDisplayIndexInStore=function(e){return 0!==this.cache.getRowCount()&&(this.displayIndexStart<=e&&e<this.getDisplayIndexEnd())},o.prototype.setDisplayIndexes=function(e,t){this.displayIndexStart=e.peek(),this.topPx=t.value,this.cache.setDisplayIndexes(e,t),this.parentRowNode.sibling&&this.blockUtils.setDisplayIndex(this.parentRowNode.sibling,e,t),this.displayIndexEnd=e.peek(),this.heightPx=t.value-this.topPx},o.prototype.forEachStoreDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),e(this,o.next()),this.cache.getNodes().forEach((function(t){var r=t.node.childStore;r&&r.forEachStoreDeep(e,o)}))},o.prototype.forEachNodeDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),this.cache.getNodes().forEach((function(t){e(t.node,o.next());var r=t.node.childStore;r&&r.forEachNodeDeep(e,o)}))},o.prototype.forEachNodeDeepAfterFilterAndSort=function(e,o,r){void 0===o&&(o=new t.NumberSequence),void 0===r&&(r=!1);var n=this.cache.getOrderedNodeMap();for(var i in n){var s=n[i];e(s.node,o.next());var d=s.node.childStore;d&&d.forEachNodeDeepAfterFilterAndSort(e,o,r)}r&&this.parentRowNode.sibling&&e(this.parentRowNode.sibling,o.next())},o.prototype.retryLoads=function(){this.cache.getNodes().forEach((function(e){var t=e.node;t.failedLoad&&(t.failedLoad=!1,t.__needsRefreshWhenVisible=!0,t.stub=!0)})),this.forEachChildStoreShallow((function(e){return e.retryLoads()})),this.fireStoreUpdatedEvent()},o.prototype.getRowUsingDisplayIndex=function(e){return this.parentRowNode.sibling&&e===this.parentRowNode.sibling.rowIndex?this.parentRowNode.sibling:this.cache.getRowByDisplayIndex(e)},o.prototype.getRowBounds=function(e){var t;if(!this.isDisplayIndexInStore(e))return null;var o=this.cache.getNodeCachedByDisplayIndex(e);if(o&&(r=this.blockUtils.extractRowBounds(o,e)))return r;var r,n=null!==(t=this.cache.getSurroundingNodesByDisplayIndex(e))&&void 0!==t?t:{},i=n.previousNode,s=n.nextNode;if(i&&null!=(r=this.blockUtils.extractRowBounds(i.node,e)))return r;var d=this.gridOptionsService.getRowHeightAsNumber();if(s){var a=(s.node.rowIndex-e)*d;return{rowTop:s.node.rowTop-a,rowHeight:d}}return{rowTop:this.topPx+this.heightPx-(this.getDisplayIndexEnd()-e)*d,rowHeight:d}},o.prototype.isPixelInRange=function(e){return e>=this.topPx&&e<this.topPx+this.heightPx},o.prototype.getRowIndexAtPixel=function(e){if(e<this.topPx)return this.getDisplayIndexStart();if(e>=this.topPx+this.heightPx)return this.getDisplayIndexEnd()-1;var t=Number.MAX_SAFE_INTEGER,o=null,r=Number.MAX_SAFE_INTEGER,n=null;if(this.cache.getNodes().forEach((function(i){var s=i.node,d=Math.abs(e-s.rowTop);s.rowTop<e?d<t&&(t=d,o=s):d<r&&(r=d,n=s)})),n=n,o=o){var i=this.blockUtils.getIndexAtPixel(o,e);if(null!=i)return i}var s=this.gridOptionsService.getRowHeightAsNumber();if(n){var d=n.rowTop,a=Math.ceil((d-e)/s);return n.rowIndex-a}var l=this.topPx+this.heightPx,c=Math.floor((l-e)/s);return this.getDisplayIndexEnd()-c},o.prototype.getChildStore=function(e){var t=this;return this.storeUtils.getChildStore(e,this,(function(e){var o=t.cache.getNodes().find((function(t){return t.node.key==e}));return o?o.node:null}))},o.prototype.forEachChildStoreShallow=function(e){this.cache.getNodes().forEach((function(t){var o=t.node;o.childStore&&e(o.childStore)}))},o.prototype.refreshAfterSort=function(e){if(this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)){var t=this.cache.getRowCount();return this.destroyBean(this.cache),this.cache=this.createManagedBean(new v(this,t,this.storeParams)),void this.fireStoreUpdatedEvent()}this.forEachChildStoreShallow((function(t){return t.refreshAfterSort(e)}))},o.prototype.refreshAfterFilter=function(e){!this.storeUtils.isServerSideOnlyRefreshFilteredGroups()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)?this.refreshStore(!0):this.forEachChildStoreShallow((function(t){return t.refreshAfterFilter(e)}))},o.prototype.refreshStore=function(e){if(e)return this.destroyBean(this.cache),this.cache=this.createManagedBean(new v(this,1,this.storeParams)),void this.fireStoreUpdatedEvent();this.cache.markNodesForRefresh()},o.prototype.getTopLevelRowDisplayedIndex=function(e){var t=this.cache.getDisplayIndexFromStoreIndex(e);return null!=t?t:e},o.prototype.isLastRowIndexKnown=function(){return this.cache.isLastRowIndexKnown()},o.prototype.getRowNodesInRange=function(e,o){return t._.missing(e),this.cache.getNodes().filter((function(t){var r=t.node;return r.rowIndex>=e.rowIndex&&r.rowIndex<=o.rowIndex})).map((function(e){return e.node}))},o.prototype.addStoreStates=function(e){e.push({suppressInfiniteScroll:!1,route:this.parentRowNode.getGroupKeys(),rowCount:this.getRowCount(),lastRowIndexKnown:this.isLastRowIndexKnown(),info:this.info,maxBlocksInCache:this.storeParams.maxBlocksInCache,cacheBlockSize:this.storeParams.cacheBlockSize}),this.forEachChildStoreShallow((function(t){return t.addStoreStates(e)}))},o.prototype.getIdSequence=function(){return this.idSequence},o.prototype.getParentNode=function(){return this.parentRowNode},o.prototype.getRowDetails=function(){return{field:this.groupField,group:this.group,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn}},o.prototype.getSsrmParams=function(){return this.ssrmParams},o.prototype.setStoreInfo=function(e){e&&Object.assign(this.info,e)},o.prototype.fireStoreUpdatedEvent=function(){var e={type:t.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)},o.prototype.fireRefreshFinishedEvent=function(){var e={type:t.Events.EVENT_STORE_REFRESHED,route:this.parentRowNode.getRoute()};this.eventService.dispatchEvent(e)},o.prototype.getBlockStates=function(){return this.cache.getBlockStates()},o.prototype.getStoreBounds=function(){return{topPx:this.topPx,heightPx:this.heightPx}},y([t.Autowired("ssrmBlockUtils")],o.prototype,"blockUtils",void 0),y([t.Autowired("ssrmStoreUtils")],o.prototype,"storeUtils",void 0),y([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),y([t.Autowired("selectionService")],o.prototype,"selectionService",void 0),y([t.PostConstruct],o.prototype,"init",null),y([t.PreDestroy],o.prototype,"destroyRowNodes",null),o}(t.BeanStub),N=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),m=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},x=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},E=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o.onRowHeightChanged_debounced=t._.debounce(o.onRowHeightChanged.bind(o),100),o.pauseStoreUpdateListening=!1,o.started=!1,o.managingPivotResultColumns=!1,o}return N(o,e),o.prototype.ensureRowHeightsValid=function(){return!1},o.prototype.start=function(){this.started=!0,this.updateDatasource()},o.prototype.destroyDatasource=function(){this.datasource&&(this.datasource.destroy&&this.datasource.destroy(),this.rowRenderer.datasourceChanged(),this.datasource=void 0)},o.prototype.addEventListeners=function(){var e=this;this.addManagedListener(this.eventService,t.Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,t.Events.EVENT_STORE_UPDATED,this.onStoreUpdated.bind(this));var o=this.resetRootStore.bind(this);this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_VALUE_CHANGED,o),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_PIVOT_CHANGED,o),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,o),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,o),this.addManagedPropertyListeners(["masterDetail","treeData","removePivotHeaderRowWhenSingleValueColumn","suppressServerSideInfiniteScroll","cacheBlockSize"],o),this.addManagedPropertyListener("rowHeight",(function(){return e.resetRowHeights()})),this.verifyProps(),this.addManagedPropertyListener("serverSideDatasource",(function(){return e.updateDatasource()}))},o.prototype.updateDatasource=function(){var e=this.gridOptionsService.get("serverSideDatasource");e&&this.setDatasource(e)},o.prototype.verifyProps=function(){this.gridOptionsService.exists("initialGroupOrderComparator")&&t._.warnOnce("initialGroupOrderComparator cannot be used with Server Side Row Model."),this.gridOptionsService.isRowSelection()&&!this.gridOptionsService.exists("getRowId")&&t._.warnOnce("getRowId callback must be provided for Server Side Row Model selection to work correctly.")},o.prototype.setDatasource=function(e){this.started&&(this.destroyDatasource(),this.datasource=e,this.resetRootStore())},o.prototype.applyRowData=function(e,t,o){var r=this.getRootStore();if(r){var n=r.getChildStore(o);n&&(n instanceof R?n.applyRowData(e,t,e.rowData.length):n instanceof i&&n.processServerResult(e))}},o.prototype.isLastRowIndexKnown=function(){var e=this.getRootStore();return!!e&&e.isLastRowIndexKnown()},o.prototype.onColumnEverything=function(){if(this.storeParams){var e=this.columnsToValueObjects(this.columnModel.getRowGroupColumns()),o=this.columnsToValueObjects(this.columnModel.getValueColumns()),r=this.columnsToValueObjects(this.columnModel.getPivotColumns()),n=function(e){var t={};e.oldCols.forEach((function(e){return t[e.id]=e}));var o=e.newCols.every((function(e){var o=t[e.id];return o&&delete t[e.id],o&&o.field===e.field&&o.aggFunc===e.aggFunc})),r=!e.allowRemovedColumns&&!!Object.values(t).length;return o&&!r},i=!t._.jsonEquals(this.storeParams.sortModel,this.sortController.getSortModel()),s=!n({oldCols:this.storeParams.rowGroupCols,newCols:e}),d=!n({oldCols:this.storeParams.pivotCols,newCols:r}),a=!!(null==e?void 0:e.length)&&!n({oldCols:this.storeParams.valueCols,newCols:o,allowRemovedColumns:!0});if(i||s||d||a)this.resetRootStore();else{var l=this.createStoreParams();this.storeParams.rowGroupCols=l.rowGroupCols,this.storeParams.pivotCols=l.pivotCols,this.storeParams.valueCols=l.valueCols}}else this.resetRootStore()},o.prototype.destroyRootStore=function(){this.rootNode&&this.rootNode.childStore&&(this.rootNode.childStore=this.destroyBean(this.rootNode.childStore),this.nodeManager.clear())},o.prototype.refreshAfterSort=function(e,t){this.storeParams&&(this.storeParams.sortModel=e);var o=this.getRootStore();o&&(o.refreshAfterSort(t),this.onStoreUpdated())},o.prototype.generateSecondaryColumns=function(e){var t=this.pivotColDefService.createColDefsFromFields(e);this.managingPivotResultColumns=!0,this.columnModel.setSecondaryColumns(t,"rowModelUpdated")},o.prototype.resetRowHeights=function(){var e=this.resetRowHeightsForAllRowNodes(),t=this.gridOptionsService.getRowHeightForNode(this.rootNode);if(this.rootNode.setRowHeight(t.height,t.estimated),this.rootNode.sibling){var o=this.gridOptionsService.getRowHeightForNode(this.rootNode.sibling);this.rootNode.sibling.setRowHeight(o.height,o.estimated)}e&&this.onRowHeightChanged()},o.prototype.resetRowHeightsForAllRowNodes=function(){var e=this,t=!1;return this.forEachNode((function(o){var r=e.gridOptionsService.getRowHeightForNode(o);o.setRowHeight(r.height,r.estimated);var n=o.detailNode;if(n){var i=e.gridOptionsService.getRowHeightForNode(n);n.setRowHeight(i.height,i.estimated)}if(o.sibling){var s=e.gridOptionsService.getRowHeightForNode(o.sibling);n.setRowHeight(s.height,s.estimated)}t=!0})),t},o.prototype.resetRootStore=function(){this.destroyRootStore(),this.rootNode=new t.RowNode(this.beans),this.rootNode.group=!0,this.rootNode.level=-1,this.datasource&&(this.storeParams=this.createStoreParams(),this.rootNode.childStore=this.createBean(this.storeFactory.createStore(this.storeParams,this.rootNode)),this.updateRowIndexesAndBounds()),this.managingPivotResultColumns&&(this.columnModel.setSecondaryColumns(null),this.managingPivotResultColumns=!1),this.dispatchModelUpdated(!0)},o.prototype.columnsToValueObjects=function(e){var t=this;return e.map((function(e){return{id:e.getId(),aggFunc:e.getAggFunc(),displayName:t.columnModel.getDisplayNameForColumn(e,"model"),field:e.getColDef().field}}))},o.prototype.createStoreParams=function(){var e=this.columnsToValueObjects(this.columnModel.getRowGroupColumns()),o=this.columnsToValueObjects(this.columnModel.getValueColumns()),r=this.columnsToValueObjects(this.columnModel.getPivotColumns()),n=this.gridOptionsService.isGetRowHeightFunction();return{valueCols:o,rowGroupCols:e,pivotCols:r,pivotMode:this.columnModel.isPivotMode(),filterModel:this.filterManager.isAdvancedFilterEnabled()?this.filterManager.getAdvancedFilterModel():this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),datasource:this.datasource,lastAccessedSequence:new t.NumberSequence,dynamicRowHeight:n}},o.prototype.getParams=function(){return this.storeParams},o.prototype.dispatchModelUpdated=function(e){void 0===e&&(e=!1);var o={type:t.Events.EVENT_MODEL_UPDATED,animate:!e,keepRenderedRows:!e,newPage:!1,newData:!1};this.eventService.dispatchEvent(o)},o.prototype.onStoreUpdated=function(){this.pauseStoreUpdateListening||(this.updateRowIndexesAndBounds(),this.dispatchModelUpdated())},o.prototype.onRowHeightChangedDebounced=function(){this.onRowHeightChanged_debounced()},o.prototype.onRowHeightChanged=function(){this.updateRowIndexesAndBounds(),this.dispatchModelUpdated()},o.prototype.updateRowIndexesAndBounds=function(){var e=this.getRootStore();e&&e.setDisplayIndexes(new t.NumberSequence,{value:0})},o.prototype.retryLoads=function(){var e=this.getRootStore();e&&(e.retryLoads(),this.onStoreUpdated())},o.prototype.getRow=function(e){var t=this.getRootStore();if(t)return t.getRowUsingDisplayIndex(e)},o.prototype.expandAll=function(e){this.pauseStoreUpdateListening=!0,this.forEachNode((function(t){t.stub||t.hasChildren()&&t.setExpanded(e)})),this.pauseStoreUpdateListening=!1,this.onStoreUpdated()},o.prototype.refreshAfterFilter=function(e,t){this.storeParams&&(this.storeParams.filterModel=e);var o=this.getRootStore();o&&(o.refreshAfterFilter(t),this.onStoreUpdated())},o.prototype.getRootStore=function(){if(this.rootNode&&this.rootNode.childStore)return this.rootNode.childStore},o.prototype.getRowCount=function(){var e=this.getRootStore();return e?e.getDisplayIndexEnd():0},o.prototype.getTopLevelRowCount=function(){var e=this.getRootStore();return e?e.getRowCount():1},o.prototype.getTopLevelRowDisplayedIndex=function(e){var t=this.getRootStore();return t?t.getTopLevelRowDisplayedIndex(e):e},o.prototype.getRowBounds=function(e){var t=this.getRootStore();return t?t.getRowBounds(e):{rowTop:0,rowHeight:this.gridOptionsService.getRowHeightAsNumber()}},o.prototype.getBlockStates=function(){var e=this.getRootStore();if(e){var t={};return e.forEachStoreDeep((function(e){if(e instanceof i){var o=e.getBlockStateJson(),r=o.id,n=o.state;t[r]=n}else{if(!(e instanceof R))throw new Error("AG Grid: Unsupported store type");Object.entries(e.getBlockStates()).forEach((function(e){var o=x(e,2),r=o[0],n=o[1];t[r]=n}))}})),t}},o.prototype.getRowIndexAtPixel=function(e){var t=this.getRootStore();return e<=0||!t?0:t.getRowIndexAtPixel(e)},o.prototype.isEmpty=function(){return!1},o.prototype.isRowsToRender=function(){return null!=this.getRootStore()&&this.getRowCount()>0},o.prototype.getType=function(){return"serverSide"},o.prototype.forEachNode=function(e){var t=this.getRootStore();t&&t.forEachNodeDeep(e)},o.prototype.forEachNodeAfterFilterAndSort=function(e,t){void 0===t&&(t=!1);var o=this.getRootStore();o&&o.forEachNodeDeepAfterFilterAndSort(e,void 0,t)},o.prototype.executeOnStore=function(e,t){if(!this.started)return!1;var o=this.getRootStore();if(!o)return!0;var r=o.getChildStore(e);return r&&t(r),!0},o.prototype.refreshStore=function(e){void 0===e&&(e={});var t=e.route?e.route:[];this.executeOnStore(t,(function(t){return t.refreshStore(1==e.purge)}))},o.prototype.getStoreState=function(){var e=[],t=this.getRootStore();return t&&t.addStoreStates(e),e},o.prototype.getNodesInRangeForSelection=function(e,o){if(!t._.exists(e))return[];if(!o)return[e];var r=e.rowIndex,n=o.rowIndex;if(null===r||null===n)return[e];var i=[],s=x([r,n].sort((function(e,t){return e-t})),2),d=s[0],a=s[1];return this.forEachNode((function(e){var t=e.rowIndex;null==t||e.stub||t>=d&&t<=a&&i.push(e)})),i.length!==a-d+1?[e]:i},o.prototype.getRowNode=function(e){var t;return this.forEachNode((function(o){o.id===e&&(t=o),o.detailNode&&o.detailNode.id===e&&(t=o.detailNode)})),t},o.prototype.isRowPresent=function(e){return!!this.getRowNode(e.id)},o.prototype.setRowCount=function(e,t){var o=this.getRootStore();if(o){if(o instanceof R)return void o.setRowCount(e,t);console.error("AG Grid: Infinite scrolling must be enabled in order to set the row count.")}},m([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),m([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),m([t.Autowired("sortController")],o.prototype,"sortController",void 0),m([t.Autowired("rowRenderer")],o.prototype,"rowRenderer",void 0),m([t.Autowired("ssrmSortService")],o.prototype,"sortListener",void 0),m([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),m([t.Autowired("ssrmStoreFactory")],o.prototype,"storeFactory",void 0),m([t.Autowired("beans")],o.prototype,"beans",void 0),m([t.Optional("pivotColDefService")],o.prototype,"pivotColDefService",void 0),m([t.PreDestroy],o.prototype,"destroyDatasource",null),m([t.PostConstruct],o.prototype,"addEventListeners",null),m([t.PreDestroy],o.prototype,"destroyRootStore",null),o=m([t.Bean("rowModel")],o)}(t.BeanStub),C=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),b=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},A=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return C(o,e),o.prototype.loadFromDatasource=function(e){var t=e.storeParams,o=e.parentBlock,r=e.parentNode.getGroupKeys();if(t.datasource){var n={startRow:e.startRow,endRow:e.endRow,rowGroupCols:t.rowGroupCols,valueCols:t.valueCols,pivotCols:t.pivotCols,pivotMode:t.pivotMode,groupKeys:r,filterModel:t.filterModel,sortModel:t.sortModel},i={success:e.success,fail:e.fail,request:n,parentNode:e.parentNode,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};window.setTimeout((function(){t.datasource&&o.isAlive()?t.datasource.getRows(i):e.fail()}),0)}},o.prototype.getChildStore=function(e,o,r){if(t._.missingOrEmpty(e))return o;var n=r(e[0]);if(n){if(1===e.length&&!n.childStore){var i=this.serverSideRowModel.getParams();n.childStore=this.createBean(this.storeFactory.createStore(i,n))}var s=e.slice(1,e.length),d=n.childStore;return d?d.getChildStore(s):null}return null},o.prototype.isServerRefreshNeeded=function(e,t,o){if(o.valueColChanged||o.secondaryColChanged)return!0;var r=e.level+1;if(!(r<t.length))return!0;var n=t[r].id;return o.changedColumns.indexOf(n)>-1||this.columnModel.getAllGridColumns().filter((function(e){return e.getColDef().showRowGroup&&o.changedColumns.includes(e.getId())})).map((function(e){return e.getColDef().showRowGroup})).some((function(e){return!0===e||e===n}))},o.prototype.getServerSideInitialRowCount=function(){return this.gridOptionsService.get("serverSideInitialRowCount")},o.prototype.assertRowModelIsServerSide=function(e){return!!this.gridOptionsService.isRowModelType("serverSide")||(t._.warnOnce("The '".concat(e,"' property can only be used with the Server Side Row Model.")),!1)},o.prototype.assertNotTreeData=function(e){return!this.gridOptionsService.get("treeData")||(t._.warnOnce("The '".concat(e,"' property cannot be used while using tree data.")),!1)},o.prototype.isServerSideSortAllLevels=function(){return this.gridOptionsService.get("serverSideSortAllLevels")&&this.assertRowModelIsServerSide("serverSideSortAllLevels")},o.prototype.isServerSideOnlyRefreshFilteredGroups=function(){return this.gridOptionsService.get("serverSideOnlyRefreshFilteredGroups")&&this.assertRowModelIsServerSide("serverSideOnlyRefreshFilteredGroups")},o.prototype.isServerSideSortOnServer=function(){return this.gridOptionsService.get("serverSideSortOnServer")&&this.assertRowModelIsServerSide("serverSideSortOnServer")&&this.assertNotTreeData("serverSideSortOnServer")},o.prototype.isServerSideFilterOnServer=function(){return this.gridOptionsService.get("serverSideFilterOnServer")&&this.assertRowModelIsServerSide("serverSideFilterOnServer")&&this.assertNotTreeData("serverSideFilterOnServer")},b([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),b([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),b([t.Autowired("ssrmStoreFactory")],o.prototype,"storeFactory",void 0),o=b([t.Bean("ssrmStoreUtils")],o)}(t.BeanStub),I=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),O=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},M=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return I(o,e),o.prototype.createRowNode=function(e){var o=new t.RowNode(this.beans),r=null!=e.rowHeight?e.rowHeight:this.gridOptionsService.getRowHeightAsNumber();return o.setRowHeight(r),o.group=e.group,o.leafGroup=e.leafGroup,o.level=e.level,o.uiLevel=e.level,o.parent=e.parent,o.stub=!0,o.__needsRefreshWhenVisible=!1,o.group&&(o.expanded=!1,o.field=e.field,o.rowGroupColumn=e.rowGroupColumn),o},o.prototype.destroyRowNodes=function(e){var t=this;e&&e.forEach((function(e){return t.destroyRowNode(e)}))},o.prototype.destroyRowNode=function(e,t){void 0===t&&(t=!1),e.childStore&&!t&&(this.destroyBean(e.childStore),e.childStore=null),e.sibling&&!e.footer&&this.destroyRowNode(e.sibling,!1),e.clearRowTopAndRowIndex(),null!=e.id&&this.nodeManager.removeNode(e)},o.prototype.setTreeGroupInfo=function(e){e.updateHasChildren();var t=this.gridOptionsService.get("getServerSideGroupKey");e.hasChildren()&&null!=t&&(e.key=t(e.data)),e.hasChildren()||null==e.childStore||(this.destroyBean(e.childStore),e.childStore=null,e.expanded=!1)},o.prototype.setRowGroupInfo=function(e){e.key=this.valueService.getValue(e.rowGroupColumn,e),null!==e.key&&void 0!==e.key||t._.doOnce((function(){console.warn("AG Grid: null and undefined values are not allowed for server side row model keys"),e.rowGroupColumn&&console.warn("column = ".concat(e.rowGroupColumn.getId())),console.warn("data is ",e.data)}),"ServerSideBlock-CannotHaveNullOrUndefinedForKey"),this.beans.gridOptionsService.getGroupIncludeFooter()({node:e})&&(e.createFooter(),e.sibling&&(e.sibling.uiLevel=e.uiLevel+1))},o.prototype.setMasterDetailInfo=function(e){var t=this.gridOptionsService.get("isRowMaster");e.master=null==t||t(e.data)},o.prototype.updateDataIntoRowNode=function(e,t){if(e.updateData(t),this.gridOptionsService.get("treeData"))this.setTreeGroupInfo(e),this.setChildCountIntoRowNode(e);else if(e.group){if(this.setChildCountIntoRowNode(e),!e.footer)this.beans.gridOptionsService.getGroupIncludeFooter()({node:e})?e.sibling?e.sibling.updateData(t):e.createFooter():e.sibling&&e.destroyFooter()}else this.gridOptionsService.get("masterDetail")},o.prototype.setDataIntoRowNode=function(e,o,r,n){var i;e.stub=!1;var s=this.gridOptionsService.get("treeData");t._.exists(o)?(e.setDataAndId(o,r),s?this.setTreeGroupInfo(e):e.group?this.setRowGroupInfo(e):this.gridOptionsService.get("masterDetail")&&this.setMasterDetailInfo(e)):(e.setDataAndId(void 0,void 0),e.key=null),(s||e.group)&&(this.setGroupDataIntoRowNode(e),this.setChildCountIntoRowNode(e)),t._.exists(o)&&(e.setRowHeight(this.gridOptionsService.getRowHeightForNode(e,!1,n).height),null===(i=e.sibling)||void 0===i||i.setRowHeight(this.gridOptionsService.getRowHeightForNode(e.sibling,!1,n).height))},o.prototype.setChildCountIntoRowNode=function(e){var t=this.gridOptionsService.get("getChildCount");t&&e.setAllChildrenCount(t(e.data))},o.prototype.setGroupDataIntoRowNode=function(e){var t=this,o=this.columnModel.getGroupDisplayColumns(),r=this.gridOptionsService.get("treeData");o.forEach((function(o){if(null==e.groupData&&(e.groupData={}),r)e.groupData[o.getColId()]=e.key;else if(o.isRowGroupDisplayed(e.rowGroupColumn.getId())){var n=t.valueService.getValue(e.rowGroupColumn,e);e.groupData[o.getColId()]=n}}))},o.prototype.clearDisplayIndex=function(e){(e.clearRowTopAndRowIndex(),e.hasChildren()&&t._.exists(e.childStore))&&e.childStore.clearDisplayIndexes();e.master&&e.detailNode&&e.detailNode.clearRowTopAndRowIndex()},o.prototype.setDisplayIndex=function(e,o,r){if((e.setRowIndex(o.next()),e.setRowTop(r.value),r.value+=e.rowHeight,!e.footer)&&(e.master&&(e.expanded&&e.detailNode?(e.detailNode.setRowIndex(o.next()),e.detailNode.setRowTop(r.value),r.value+=e.detailNode.rowHeight):e.detailNode&&e.detailNode.clearRowTopAndRowIndex()),e.hasChildren()&&t._.exists(e.childStore))){var n=e.childStore;e.expanded?n.setDisplayIndexes(o,r):n.clearDisplayIndexes()}},o.prototype.binarySearchForDisplayIndex=function(e,o){var r=0,n=o.length-1;if(t._.missing(n)||t._.missing(r))console.warn("AG Grid: error: topPointer = ".concat(n,", bottomPointer = ").concat(r));else for(;;){var i=Math.floor((r+n)/2),s=o[i];if(s.rowIndex===e)return s;var d=s.master&&s.expanded,a=s.detailNode;if(d&&a&&a.rowIndex===e)return s.detailNode;var l=s.childStore;if(s.expanded&&l&&l.isDisplayIndexInStore(e))return l.getRowUsingDisplayIndex(e);if(s.rowIndex<e)r=i+1;else{if(!(s.rowIndex>e))return void console.warn("AG Grid: error: unable to locate rowIndex = ".concat(e," in cache"));n=i-1}}},o.prototype.extractRowBounds=function(e,o){var r=function(e){return{rowHeight:e.rowHeight,rowTop:e.rowTop}};if(e.rowIndex===o)return r(e);if(e.hasChildren()&&e.expanded&&t._.exists(e.childStore)){var n=e.childStore;if(n.isDisplayIndexInStore(o))return n.getRowBounds(o)}else if(e.master&&e.expanded&&t._.exists(e.detailNode)&&e.detailNode.rowIndex===o)return r(e.detailNode)},o.prototype.getIndexAtPixel=function(e,o){if(e.isPixelInRange(o))return e.rowIndex;var r=e.master&&e.expanded,n=e.detailNode;if(r&&n&&n.isPixelInRange(o))return e.detailNode.rowIndex;if(e.hasChildren()&&e.expanded&&t._.exists(e.childStore)){var i=e.childStore;if(i.isPixelInRange(o))return i.getRowIndexAtPixel(o)}return null},o.prototype.createNodeIdPrefix=function(e){for(var t=[],o=e;o&&o.level>=0;)""===o.key?t.push("ag-Grid-MissingKey"):t.push(o.key),o=o.parent;if(t.length>0)return t.reverse().join("-")},o.prototype.checkOpenByDefault=function(e){return this.expansionService.checkOpenByDefault(e)},O([t.Autowired("valueService")],o.prototype,"valueService",void 0),O([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),O([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),O([t.Autowired("beans")],o.prototype,"beans",void 0),O([t.Autowired("expansionService")],o.prototype,"expansionService",void 0),o=O([t.Bean("ssrmBlockUtils")],o)}(t.BeanStub),D=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},_=function(){function e(){this.rowNodes={}}return e.prototype.addRowNode=function(e){var t=e.id;this.rowNodes[t]&&(console.warn("AG Grid: Duplicate node id ".concat(e.id,". Row ID's are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.")),console.warn("first instance",this.rowNodes[t].data),console.warn("second instance",e.data)),this.rowNodes[t]=e},e.prototype.removeNode=function(e){var t=e.id;this.rowNodes[t]&&(this.rowNodes[t]=void 0)},e.prototype.clear=function(){this.rowNodes={}},D([t.PreDestroy],e.prototype,"clear",null),e=D([t.Bean("ssrmNodeManager")],e)}(),P=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),T=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},L=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.asyncTransactions=[],t}return P(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")},o.prototype.applyTransactionAsync=function(e,t){null==this.asyncTransactionsTimeout&&this.scheduleExecuteAsync(),this.asyncTransactions.push({transaction:e,callback:t})},o.prototype.scheduleExecuteAsync=function(){var e=this,t=this.gridOptionsService.getAsyncTransactionWaitMillis();this.asyncTransactionsTimeout=window.setTimeout((function(){e.executeAsyncTransactions()}),t)},o.prototype.executeAsyncTransactions=function(){var e=this;if(this.asyncTransactions){var o=[],r=[],n=[],i=!1;if(this.asyncTransactions.forEach((function(s){var d;e.serverSideRowModel.executeOnStore(s.transaction.route,(function(e){d=e.applyTransaction(s.transaction)}))?null==d&&(d={status:t.ServerSideTransactionResultStatus.StoreNotFound}):d={status:t.ServerSideTransactionResultStatus.StoreNotStarted},r.push(d),d.status==t.ServerSideTransactionResultStatus.StoreLoading?n.push(s):(s.callback&&o.push((function(){return s.callback(d)})),d.status===t.ServerSideTransactionResultStatus.Applied&&(i=!0))})),o.length>0&&window.setTimeout((function(){o.forEach((function(e){return e()}))}),0),this.asyncTransactionsTimeout=void 0,this.asyncTransactions=n,i&&(this.valueCache.onDataChanged(),this.eventService.dispatchEvent({type:t.Events.EVENT_STORE_UPDATED})),r.length>0){var s={type:t.Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:r};this.eventService.dispatchEvent(s)}}},o.prototype.flushAsyncTransactions=function(){null!=this.asyncTransactionsTimeout&&clearTimeout(this.asyncTransactionsTimeout),this.executeAsyncTransactions()},o.prototype.applyTransaction=function(e){var o;if(this.serverSideRowModel.executeOnStore(e.route,(function(t){o=t.applyTransaction(e)}))){if(o){if(this.valueCache.onDataChanged(),o.remove){var r=o.remove.map((function(e){return e.id}));this.selectionService.deleteSelectionStateFromParent(e.route||[],r)}return this.eventService.dispatchEvent({type:t.Events.EVENT_STORE_UPDATED}),o}return{status:t.ServerSideTransactionResultStatus.StoreNotFound}}return{status:t.ServerSideTransactionResultStatus.StoreNotStarted}},T([t.Autowired("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),T([t.Autowired("valueCache")],o.prototype,"valueCache",void 0),T([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),T([t.Autowired("rowRenderer")],o.prototype,"rowRenderer",void 0),T([t.Autowired("selectionService")],o.prototype,"selectionService",void 0),T([t.PostConstruct],o.prototype,"postConstruct",null),o=T([t.Bean("ssrmTransactionManager")],o)}(t.BeanStub),k=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),G=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},B=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return k(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,t.Events.EVENT_ROW_GROUP_OPENED,this.onRowGroupOpened.bind(this))},o.prototype.onRowGroupOpened=function(e){var o=e.node;if(o.expanded){if(o.master)this.createDetailNode(o);else if(t._.missing(o.childStore)){var r=this.serverSideRowModel.getParams();o.childStore=this.createBean(this.storeFactory.createStore(r,o))}}else this.gridOptionsService.get("purgeClosedRowNodes")&&t._.exists(o.childStore)&&(o.childStore=this.destroyBean(o.childStore));var n={type:t.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(n)},o.prototype.createDetailNode=function(e){if(t._.exists(e.detailNode))return e.detailNode;var o=new t.RowNode(this.beans);o.detail=!0,o.selectable=!1,o.parent=e,t._.exists(e.id)&&(o.id="detail_"+e.id),o.data=e.data,o.level=e.level+1;var r=this.gridOptionsService.getRowHeightForNode(o).height;return o.rowHeight=r||200,e.detailNode=o,o},G([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),G([t.Autowired("ssrmStoreFactory")],o.prototype,"storeFactory",void 0),G([t.Autowired("beans")],o.prototype,"beans",void 0),G([t.PostConstruct],o.prototype,"postConstruct",null),o=G([t.Bean("ssrmExpandListener")],o)}(t.BeanStub),F=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),j=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},U=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return F(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,t.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this))},o.prototype.onSortChanged=function(){var e=this.serverSideRowModel.getParams();if(e){var t=this.sortController.getSortModel(),o=e.sortModel,r=this.findChangedColumnsInSort(t,o),n={valueColChanged:this.listenerUtils.isSortingWithValueColumn(r),secondaryColChanged:this.listenerUtils.isSortingWithSecondaryColumn(r),changedColumns:r};this.serverSideRowModel.refreshAfterSort(t,n)}},o.prototype.findChangedColumnsInSort=function(e,t){var o=[];[e,t].forEach((function(e){if(e){var t=e.map((function(e){return e.colId}));o=o.concat(t)}}));return o.filter((function(o){var r=t.find((function(e){return e.colId===o})),n=e.find((function(e){return e.colId===o}));return function(e,t){return(e?e.sort:null)!==(t?t.sort:null)}(r,n)||function(o,r){return(o?t.indexOf(o):-1)!==(r?e.indexOf(r):-1)}(r,n)}))},j([t.Autowired("sortController")],o.prototype,"sortController",void 0),j([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),j([t.Autowired("ssrmListenerUtils")],o.prototype,"listenerUtils",void 0),j([t.PostConstruct],o.prototype,"postConstruct",null),o=j([t.Bean("ssrmSortService")],o)}(t.BeanStub),V=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),H=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},q=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.postConstruct=function(){var e=this;this.gridOptionsService.isRowModelType("serverSide")&&(this.addManagedListener(this.eventService,t.Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,(function(){return e.onFilterChanged(!0)})),this.addManagedListener(this.eventService,t.Events.EVENT_FILTER_CHANGED,(function(){return e.onFilterChanged()})))},o.prototype.onFilterChanged=function(e){var t=this.serverSideRowModel.getParams();if(t){var o,r,n=t.filterModel;if(this.filterManager.isAdvancedFilterEnabled()){o=this.filterManager.getAdvancedFilterModel();var i=e?Object.keys(null!=n?n:{}):this.getAdvancedFilterColumns(n),s=this.getAdvancedFilterColumns(o);i.forEach((function(e){return s.add(e)})),r=Array.from(s)}else if(o=this.filterManager.getFilterModel(),e){var d=this.getAdvancedFilterColumns(n);Object.keys(o).forEach((function(e){return d.add(e)})),r=Array.from(d)}else r=this.findChangedColumns(n,o);var a={valueColChanged:this.listenerUtils.isSortingWithValueColumn(r),secondaryColChanged:this.listenerUtils.isSortingWithSecondaryColumn(r),changedColumns:r};this.serverSideRowModel.refreshAfterFilter(o,a)}},o.prototype.findChangedColumns=function(e,t){var o={};Object.keys(e).forEach((function(e){return o[e]=!0})),Object.keys(t).forEach((function(e){return o[e]=!0}));var r=[];return Object.keys(o).forEach((function(o){JSON.stringify(e[o])!=JSON.stringify(t[o])&&r.push(o)})),r},o.prototype.getAdvancedFilterColumns=function(e){var t=new Set;if(!e)return t;var o=function(e){"join"===e.filterType?e.conditions.forEach((function(e){return o(e)})):t.add(e.colId)};return o(e),t},H([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),H([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),H([t.Autowired("ssrmListenerUtils")],o.prototype,"listenerUtils",void 0),H([t.PostConstruct],o.prototype,"postConstruct",null),o=H([t.Bean("ssrmFilterListener")],o)}(t.BeanStub),z=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},K=function(){function e(){}return e.prototype.createStore=function(e,t){var o=this.getStoreParams(e,t);return new(o.suppressInfiniteScroll?i:R)(e,o,t)},e.prototype.getStoreParams=function(e,t){var o=this.getLevelSpecificParams(t),r=this.isInfiniteScroll(o);return{suppressInfiniteScroll:!r,cacheBlockSize:this.getBlockSize(r,o),maxBlocksInCache:this.getMaxBlocksInCache(r,e,o)}},e.prototype.getMaxBlocksInCache=function(e,o,r){if(e){var n=r&&null!=r.maxBlocksInCache?r.maxBlocksInCache:this.gridOptionsService.get("maxBlocksInCache");if(null!=n&&n>=0)if(o.dynamicRowHeight){var i="Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.";t._.warnOnce(i)}else{if(!this.columnModel.isAutoRowHeightActive())return n;i="Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.";t._.warnOnce(i)}}},e.prototype.getBlockSize=function(e,t){if(e){var o=t&&null!=t.cacheBlockSize?t.cacheBlockSize:this.gridOptionsService.get("cacheBlockSize");return null!=o&&o>0?o:100}},e.prototype.getLevelSpecificParams=function(e){var t=this.gridOptionsService.getCallback("getServerSideGroupLevelParams");if(t)return t({level:e.level+1,parentRowNode:e.level>=0?e:void 0,rowGroupColumns:this.columnModel.getRowGroupColumns(),pivotColumns:this.columnModel.getPivotColumns(),pivotMode:this.columnModel.isPivotMode()})},e.prototype.isInfiniteScroll=function(e){return!(e&&null!=e.suppressInfiniteScroll?e.suppressInfiniteScroll:this.isSuppressServerSideInfiniteScroll())},e.prototype.isSuppressServerSideInfiniteScroll=function(){return this.gridOptionsService.get("suppressServerSideInfiniteScroll")},z([t.Autowired("gridOptionsService")],e.prototype,"gridOptionsService",void 0),z([t.Autowired("columnModel")],e.prototype,"columnModel",void 0),e=z([t.Bean("ssrmStoreFactory")],e)}(),W=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},J=function(){function e(){}return e.prototype.isSortingWithValueColumn=function(e){for(var t=this.columnModel.getValueColumns().map((function(e){return e.getColId()})),o=0;o<e.length;o++)if(t.indexOf(e[o])>-1)return!0;return!1},e.prototype.isSortingWithSecondaryColumn=function(e){if(!this.columnModel.getSecondaryColumns())return!1;for(var t=this.columnModel.getSecondaryColumns().map((function(e){return e.getColId()})),o=0;o<e.length;o++)if(t.indexOf(e[o])>-1)return!0;return!1},W([t.Autowired("columnModel")],e.prototype,"columnModel",void 0),e=W([t.Bean("ssrmListenerUtils")],e)}(),Q=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),X=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Y=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},Z=function(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},$=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedState={selectAll:!1,toggledNodes:new Set},t.lastSelected=null,t.selectAllUsed=!1,t.selectedNodes={},t}return Q(o,e),o.prototype.init=function(){var e=this;this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(function(t){e.rowSelection=t.currentValue}))},o.prototype.getSelectedState=function(){return{selectAll:this.selectedState.selectAll,toggledNodes:Z([],Y(this.selectedState.toggledNodes),!1)}},o.prototype.setSelectedState=function(e){var t={selectAll:!1,toggledNodes:new Set};"object"==typeof e?"selectAll"in e&&"boolean"==typeof e.selectAll?(t.selectAll=e.selectAll,"toggledNodes"in e&&Array.isArray(e.toggledNodes)?(e.toggledNodes.forEach((function(e){"string"==typeof e?t.toggledNodes.add(e):console.warn("AG Grid: Provided ids must be of string type. Invalid id provided: ".concat(e))})),this.selectedState=t):console.error("AG Grid: `toggledNodes` must be an array of string ids.")):console.error("AG Grid: Select all status should be of boolean type."):console.error("AG Grid: The provided selection state should be an object.")},o.prototype.deleteSelectionStateFromParent=function(e,t){var o=this;if(0===this.selectedState.toggledNodes.size)return!1;var r=!1;return t.forEach((function(e){o.selectedState.toggledNodes.delete(e)&&(r=!0)})),r},o.prototype.setNodesSelected=function(e){var t,o=this;if(0===e.nodes.length)return 0;var r=e.clearSelection&&e.newValue&&!e.rangeSelect;if("multiple"!==this.rowSelection||r){if(e.nodes.length>1)throw new Error("AG Grid: cannot select multiple rows when rowSelection is set to 'single'");var n=e.nodes[0];return e.newValue?(this.selectedNodes=((t={})[n.id]=n,t),this.selectedState={selectAll:!1,toggledNodes:new Set([n.id])}):(this.selectedNodes={},this.selectedState={selectAll:!1,toggledNodes:new Set}),this.lastSelected=n.id,1}var i=function(t){e.newValue?o.selectedNodes[t.id]=t:delete o.selectedNodes[t.id];var r=t.selectable;e.newValue===o.selectedState.selectAll||!r?o.selectedState.toggledNodes.delete(t.id):o.selectedState.toggledNodes.add(t.id)};if(e.rangeSelect&&this.lastSelected){if(e.nodes.length>1)throw new Error("AG Grid: cannot select multiple rows when using rangeSelect");n=e.nodes[0];var s=this.rowModel.getRowNode(this.lastSelected);return this.rowModel.getNodesInRangeForSelection(n,null!=s?s:null).forEach(i),this.lastSelected=n.id,1}return e.nodes.forEach(i),this.lastSelected=e.nodes[e.nodes.length-1].id,1},o.prototype.processNewRow=function(e){this.selectedNodes[e.id]&&(this.selectedNodes[e.id]=e)},o.prototype.isNodeSelected=function(e){var t=this.selectedState.toggledNodes.has(e.id);return this.selectedState.selectAll?!t:t},o.prototype.getSelectedNodes=function(){return this.selectAllUsed&&console.warn("AG Grid: getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model.\n                Use `api.getServerSideSelectionState()` instead."),Object.values(this.selectedNodes)},o.prototype.getSelectedRows=function(){return this.getSelectedNodes().map((function(e){return e.data}))},o.prototype.getSelectionCount=function(){return this.selectedState.selectAll?-1:this.selectedState.toggledNodes.size},o.prototype.clearOtherNodes=function(e,o){var r=this.selectedState.selectAll?1:this.selectedState.toggledNodes.size-1;this.selectedState={selectAll:!1,toggledNodes:new Set([e.id])},this.rowModel.forEachNode((function(t){t!==e&&t.selectThisNode(!1,void 0,o)}));var n={type:t.Events.EVENT_SELECTION_CHANGED,source:o};return this.eventService.dispatchEvent(n),r},o.prototype.isEmpty=function(){var e;return!this.selectedState.selectAll&&!(null===(e=this.selectedState.toggledNodes)||void 0===e?void 0:e.size)},o.prototype.selectAllRowNodes=function(e){this.selectedState={selectAll:!0,toggledNodes:new Set},this.selectedNodes={},this.selectAllUsed=!0},o.prototype.deselectAllRowNodes=function(e){this.selectedState={selectAll:!1,toggledNodes:new Set},this.selectedNodes={}},o.prototype.getSelectAllState=function(e,t){return this.selectedState.selectAll?!(this.selectedState.toggledNodes.size>0)||null:this.selectedState.toggledNodes.size>0&&null},X([t.Autowired("rowModel")],o.prototype,"rowModel",void 0),X([t.PostConstruct],o.prototype,"init",null),o}(t.BeanStub),ee=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),te=function(){return(te=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},oe=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},re=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(o[r[n]]=e[r[n]])}return o},ne=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},ie=function(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},se=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedState={selectAllChildren:!1,toggledNodes:new Map},t.lastSelected=null,t}return ee(o,e),o.prototype.init=function(){var e=this;this.addManagedListener(this.eventService,t.Events.EVENT_MODEL_UPDATED,(function(){return e.removeRedundantState()})),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return e.selectionService.reset("rowGroupChanged")}))},o.prototype.getSelectedState=function(){var e=this,t=function(o,r,n){var i={nodeId:n};if(r<=e.columnModel.getRowGroupColumns().length&&(i.selectAllChildren=o.selectAllChildren),o.toggledNodes.size){var s=[];o.toggledNodes.forEach((function(e,o){var n=t(e,r+1,o);s.push(n)})),i.toggledNodes=s}return i};return t(this.selectedState,0)},o.prototype.setSelectedState=function(e){var t=function(e,o){var r,n;if("object"!=typeof e)throw new Error("AG Grid: Each provided state object must be an object.");if("selectAllChildren"in e&&"boolean"!=typeof e.selectAllChildren)throw new Error("AG Grid: `selectAllChildren` must be a boolean value or undefined.");if("toggledNodes"in e){if(!Array.isArray(e.toggledNodes))throw new Error("AG Grid: `toggledNodes` must be an array.");if(!e.toggledNodes.every((function(e){return"object"==typeof e&&"nodeId"in e&&"string"==typeof e.nodeId})))throw new Error("AG Grid: Every `toggledNode` requires an associated string id.")}var i=null!==(r=e.selectAllChildren)&&void 0!==r?r:!o,s=null===(n=e.toggledNodes)||void 0===n?void 0:n.map((function(e){return[e.nodeId,t(e,i)]}));if(null==s?void 0:s.some((function(e){var t=ne(e,2);t[0];var o=t[1];return i===o.selectAllChildren&&0===o.toggledNodes.size})))throw new Error("\n                    AG Grid: AG Grid: Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule.\n                    Please rebuild the selection state and reapply it.\n                ");return{selectAllChildren:i,toggledNodes:new Map(s)}};try{this.selectedState=t(e,!!e.selectAllChildren)}catch(e){console.error(e.message)}},o.prototype.deleteSelectionStateFromParent=function(e,t){for(var o=this.selectedState,r=ie([],ne(e),!1);o&&r.length;)o=o.toggledNodes.get(r.pop());if(!o)return!1;var n=!1;return t.forEach((function(e){(null==o?void 0:o.toggledNodes.delete(e))&&(n=!0)})),n&&this.removeRedundantState(),n},o.prototype.setNodesSelected=function(e){var t=this,o=e.nodes,r=re(e,["nodes"]);if(0===o.length)return 0;if(e.rangeSelect){if(o.length>1)throw new Error("AG Grid: cannot select multiple rows when using rangeSelect");var n=o[0],i=this.rowModel.getNodesInRangeForSelection(n,this.lastSelected).map(this.getRouteToNode).sort((function(e,t){return t.length-e.length})),s=new Set;return i.forEach((function(e){s.has(e[e.length-1])||(e.forEach((function(e){return s.add(e)})),t.recursivelySelectNode(e,t.selectedState,te({node:n},r)))})),this.removeRedundantState(),this.lastSelected=n,1}return e.nodes.forEach((function(e){var o=t.getRouteToNode(e);t.recursivelySelectNode(o,t.selectedState,te(te({},r),{node:e}))})),this.removeRedundantState(),this.lastSelected=e.nodes[e.nodes.length-1],1},o.prototype.isNodeSelected=function(e){var t=this.getRouteToNode(e);return this.isNodePathSelected(t,this.selectedState)},o.prototype.isNodePathSelected=function(e,t){var o=ne(e),r=o[0],n=o.slice(1);if(0===n.length){var i=t.toggledNodes.has(r.id);if(r.hasChildren()){var s=t.toggledNodes.get(r.id);if(s&&s.toggledNodes.size)return}return t.selectAllChildren?!i:i}if(t.toggledNodes.has(r.id)){var d=t.toggledNodes.get(r.id);if(d)return this.isNodePathSelected(n,d)}return!!t.selectAllChildren},o.prototype.getRouteToNode=function(e){for(var t=[],o=e;o.parent;)t.push(o),o=o.parent;return t.reverse()},o.prototype.removeRedundantState=function(){var e=this;if(!this.filterManager.isAnyFilterPresent()){var t=function(o,r,n){void 0===o&&(o=e.selectedState),void 0===r&&(r=e.serverSideRowModel.getRootStore());var i=!0,s=!0;return o.toggledNodes.forEach((function(r,n){var d=e.rowModel.getRowNode(n);d||(i=!1);var a=null==d?void 0:d.childStore;a?(t(r,a,d)&&o.selectAllChildren===r.selectAllChildren&&o.toggledNodes.delete(n),r.toggledNodes.size>0&&(s=!1)):r.toggledNodes.size>0&&(s=!1)})),!(!r||!r.isLastRowIndexKnown()||r.getRowCount()!==o.toggledNodes.size)&&(!(!s||!i)&&(o.toggledNodes.clear(),o.selectAllChildren=!o.selectAllChildren,n&&(null==n?void 0:n.isSelected())!==o.selectAllChildren&&n.selectThisNode(o.selectAllChildren,void 0,"api"),!0))};t()}},o.prototype.recursivelySelectNode=function(e,t,o){var r=ne(e),n=r[0],i=r.slice(1);if(n)if(!i.length){var s=n.selectable;if(t.selectAllChildren===o.newValue||!s)return void t.toggledNodes.delete(n.id);var d={selectAllChildren:o.newValue,toggledNodes:new Map};t.toggledNodes.set(n.id,d)}else{var a=t.toggledNodes.has(n.id),l=a?t.toggledNodes.get(n.id):{selectAllChildren:t.selectAllChildren,toggledNodes:new Map};a||t.toggledNodes.set(n.id,l),this.recursivelySelectNode(i,l,o),t.selectAllChildren===l.selectAllChildren&&0===l.toggledNodes.size&&t.toggledNodes.delete(n.id)}},o.prototype.getSelectedNodes=function(){console.warn("AG Grid: `getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model.\n            Use `api.getServerSideSelectionState()` instead.");var e=[];return this.rowModel.forEachNode((function(t){t.isSelected()&&e.push(t)})),e},o.prototype.processNewRow=function(e){},o.prototype.getSelectedRows=function(){return this.getSelectedNodes().map((function(e){return e.data}))},o.prototype.getSelectionCount=function(){return-1},o.prototype.isEmpty=function(){var e;return!this.selectedState.selectAllChildren&&!(null===(e=this.selectedState.toggledNodes)||void 0===e?void 0:e.size)},o.prototype.selectAllRowNodes=function(e){this.selectedState={selectAllChildren:!0,toggledNodes:new Map}},o.prototype.deselectAllRowNodes=function(e){this.selectedState={selectAllChildren:!1,toggledNodes:new Map}},o.prototype.getSelectAllState=function(e,t){return this.selectedState.selectAllChildren?!(this.selectedState.toggledNodes.size>0)||null:this.selectedState.toggledNodes.size>0&&null},oe([t.Autowired("rowModel")],o.prototype,"rowModel",void 0),oe([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),oe([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),oe([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),oe([t.Autowired("selectionService")],o.prototype,"selectionService",void 0),oe([t.PostConstruct],o.prototype,"init",null),o}(t.BeanStub),de=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),ae=function(){return(ae=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},le=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},ce=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(o[r[n]]=e[r[n]])}return o},ue=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return de(o,e),o.prototype.init=function(){var e=this,o=this.gridOptionsService.get("groupSelectsChildren");this.addManagedPropertyListener("groupSelectsChildren",(function(o){e.destroyBean(e.selectionStrategy);var r=o.currentValue?se:$;e.selectionStrategy=e.createManagedBean(new r),e.shotgunResetNodeSelectionState();var n={type:t.Events.EVENT_SELECTION_CHANGED,source:"api"};e.eventService.dispatchEvent(n)})),this.addManagedPropertyListener("rowSelection",(function(){return e.deselectAllRowNodes({source:"api"})}));var r=o?se:$;this.selectionStrategy=this.createManagedBean(new r)},o.prototype.getSelectionState=function(){return this.selectionStrategy.getSelectedState()},o.prototype.setSelectionState=function(e,o){if(!Array.isArray(e)){this.selectionStrategy.setSelectedState(e),this.shotgunResetNodeSelectionState();var r={type:t.Events.EVENT_SELECTION_CHANGED,source:o};this.eventService.dispatchEvent(r)}},o.prototype.setNodesSelected=function(e){var o=e.nodes,r=ce(e,["nodes"]),n=this.gridOptionsService.get("rowSelection");if(o.length>1&&"multiple"!==n)return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;if(o.length>1&&e.rangeSelect)return console.warn("AG Grid: cannot use range selection when multi selecting rows"),0;var i=ae({nodes:o.filter((function(e){return e.selectable}))},r);if(!i.nodes.length)return 0;var s=this.selectionStrategy.setNodesSelected(i);this.shotgunResetNodeSelectionState(i.source);var d={type:t.Events.EVENT_SELECTION_CHANGED,source:i.source};return this.eventService.dispatchEvent(d),s},o.prototype.deleteSelectionStateFromParent=function(e,o){if(this.selectionStrategy.deleteSelectionStateFromParent(e,o)){this.shotgunResetNodeSelectionState();var r={type:t.Events.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(r)}},o.prototype.shotgunResetNodeSelectionState=function(e){var t=this;this.rowModel.forEachNode((function(o){if(!o.stub){var r=t.selectionStrategy.isNodeSelected(o);r!==o.isSelected()&&o.selectThisNode(r,void 0,e)}}))},o.prototype.getSelectedNodes=function(){return this.selectionStrategy.getSelectedNodes()},o.prototype.getSelectedRows=function(){return this.selectionStrategy.getSelectedRows()},o.prototype.getSelectionCount=function(){return this.selectionStrategy.getSelectionCount()},o.prototype.syncInRowNode=function(e,o){this.selectionStrategy.processNewRow(e);var r=this.selectionStrategy.isNodeSelected(e);if(0==r||e.selectable)e.setSelectedInitialValue(r);else{this.selectionStrategy.setNodesSelected({nodes:[e],newValue:!1,source:"api"}),this.shotgunResetNodeSelectionState();var n={type:t.Events.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(n)}},o.prototype.reset=function(){this.selectionStrategy.deselectAllRowNodes({source:"api"})},o.prototype.isEmpty=function(){return this.selectionStrategy.isEmpty()},o.prototype.selectAllRowNodes=function(e){(e.justCurrentPage||e.justFiltered)&&console.warn("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'"),this.selectionStrategy.selectAllRowNodes(e),this.rowModel.forEachNode((function(t){t.stub||t.selectThisNode(!0,void 0,e.source)}));var o={type:t.Events.EVENT_SELECTION_CHANGED,source:e.source};this.eventService.dispatchEvent(o)},o.prototype.deselectAllRowNodes=function(e){(e.justCurrentPage||e.justFiltered)&&console.warn("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'"),this.selectionStrategy.deselectAllRowNodes(e),this.rowModel.forEachNode((function(t){t.stub||t.selectThisNode(!1,void 0,e.source)}));var o={type:t.Events.EVENT_SELECTION_CHANGED,source:e.source};this.eventService.dispatchEvent(o)},o.prototype.getSelectAllState=function(e,t){return this.selectionStrategy.getSelectAllState(e,t)},o.prototype.updateGroupsFromChildrenSelections=function(e,t){return!1},o.prototype.getBestCostNodeSelection=function(){console.warn("AG Grid: calling gridApi.getBestCostNodeSelection() is only possible when using rowModelType=`clientSide`.")},o.prototype.filterFromSelection=function(){},le([t.Autowired("rowModel")],o.prototype,"rowModel",void 0),le([t.PostConstruct],o.prototype,"init",null),o=le([t.Bean("selectionService")],o)}(t.BeanStub),pe=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),he=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},fe=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.queuedRowIds=new Set,t}return pe(o,e),o.prototype.postConstruct=function(){var o=this;e.prototype.postConstruct.call(this),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){o.queuedRowIds.clear()}))},o.prototype.checkOpenByDefault=function(e){if(e.isExpandable()){var t=function(){window.setTimeout((function(){return e.setExpanded(!0)}),0)};if(this.queuedRowIds.has(e.id))return this.queuedRowIds.delete(e.id),void t();var o=this.gridOptionsService.getCallback("isServerSideGroupOpenByDefault");if(o)o({data:e.data,rowNode:e})&&t()}},o.prototype.expandRows=function(e){var t=this;e.forEach((function(e){var o=t.serverSideRowModel.getRowNode(e);o?o.setExpanded(!0):t.queuedRowIds.add(e)}))},o.prototype.expandAll=function(e){this.serverSideRowModel.expandAll(e)},o.prototype.onGroupExpandedOrCollapsed=function(){},he([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),o=he([t.Bean("expansionService")],o)}(t.ExpansionService),ve={version:"31.0.0",moduleName:t.ModuleNames.ServerSideRowModelModule,rowModel:"serverSide",beans:[E,B,U,A,M,_,L,q,K,J,ue,fe],dependantModules:[o.EnterpriseCoreModule]};exports.ServerSideRowModelModule=ve;